# Thread Information
Title: Thread-214028
Section: RouterOS
Thread ID: 214028

# Discussion

## Initial Question
OpenVPN Connect 3.6.0 successfully connects to the ROS 7.17 OpenVPN Server. However, when accessing an intranet webpage, the OpenVPN client disconnects with the message: “Required credentials are missing for the reconnection attempt.” .Reviewing the logs reveals a decryption failure warning.Testing revealed that there might be an issue with AES-256-GCM decryption, but OpenVPN Connect uses AES-256-GCM by default. I’d like to ask if ROS 7.1.7 has made any changes to the AES-256-GCM implementation.
```
[Jan20,2025,16:22:21]OpenVPNcore3.10.5win x86_6464-bit OVPN-DCO built onDec17202412:24:32⏎[Jan20,2025,16:22:21]Frame=512/2112/512mssfix-ctrl=1250⏎[Jan20,2025,16:22:21]NOTE:Thisconfiguration contains options that werenotused:⏎[Jan20,2025,16:22:21]Unsupportedoption(ignored)⏎[Jan20,2025,16:22:21]0[resolv-retry][infinite]⏎[Jan20,2025,16:22:21]1[persist-key]⏎[Jan20,2025,16:22:21]2[persist-tun]⏎[Jan20,2025,16:22:21]EVENT:RESOLVE⏎[Jan20,2025,16:22:21]EVENT:WAIT⏎[Jan20,2025,16:22:21]WinCommandAgent:transmitting bypass route to117.88.226.24{"host":"117.88.226.24","ipv6":false}⏎[Jan20,2025,16:22:21]Connectingto[xxx.com]:1194(117.88.226.24)viaTCPv4⏎[Jan20,2025,16:22:21]EVENT:CONNECTING⏎[Jan20,2025,16:22:21]TunnelOptions:V4,dev-type tun,link-mtu1523,tun-mtu1500,protoTCPv4_CLIENT,cipher AES-256-GCM,auth[null-digest],keysize256,key-method2,tls-client⏎[Jan20,2025,16:22:21]Creds:Username/Password⏎[Jan20,2025,16:22:21]Clearingcredentials⏎[Jan20,2025,16:22:21]SendingPeerInfo:IV_VER=3.10.5IV_PLAT=win
IV_NCP=2IV_TCPNL=1IV_PROTO=2974IV_MTU=1600IV_CIPHERS=AES-128-CBC:AES-192-CBC:AES-256-CBC:AES-128-GCM:AES-192-GCM:AES-256-GCM:CHACHA20-POLY1305
IV_GUI_VER=OCWindows_3.6.0-4074IV_SSO=webauth,crtext⏎[Jan20,2025,16:22:21]SSLHandshake:peer certificate:CN=*.ros-vpn-dtops.cc,2048bit RSA,cipher:ECDHE-RSA-AES256-GCM-SHA384TLSv1.2Kx=ECDHAu=RSAEnc=AESGCM(256)Mac=AEAD⏎[Jan20,2025,16:22:21]SessionisACTIVE⏎[Jan20,2025,16:22:21]EVENT:GET_CONFIG⏎[Jan20,2025,16:22:21]SendingPUSH_REQUEST to server...⏎[Jan20,2025,16:22:21]OPTIONS:0[dhcp-option][DNS][223.5.5.5]1[dhcp-option][DNS][223.6.6.6]2[ping][5]3[ping-restart][15]4[topology][subnet]5[route-gateway][172.20.0.254]6[route][10.0.0.0][255.255.255.0]7[route][172.16.16.0][255.255.255.0]8[route][192.168.88.0][255.255.254.0]9[route][10.30.0.0][255.255.0.0]10[ifconfig][172.20.0.237][255.255.255.0]11[peer-id][21]⏎[Jan20,2025,16:22:21]PROTOCOL OPTIONS:cipher:AES-256-GCM
  digest:none
  key-derivation:OpenVPNPRF
  compress:NONE
  peer ID:21⏎[Jan20,2025,16:22:21]EVENT:ASSIGN_IP⏎[Jan20,2025,16:22:21]CAPTURED OPTIONS:SessionName:xxx.comLayer:OSI_LAYER_3RemoteAddress:117.88.226.24TunnelAddresses:172.20.0.237/24->172.20.0.254RerouteGateway:IPv4=0IPv6=0flags=[IPv4]BlockIPv4:noBlockIPv6:noBlocklocalDNS:noAddRoutes:10.0.0.0/24172.16.16.0/24192.168.88.0/2310.30.0.0/16ExcludeRoutes:DNSServers:223.5.5.5223.6.6.6⏎[Jan20,2025,16:22:21]SetupClient:transmitting tun setup list to \\.\pipe\agent_ovpnconnect{"allow_local_dns_resolvers":false,"confirm_event":"4811000000000000","destroy_event":"2811000000000000","tun":{"adapter_domain_suffix":"","add_routes":[{"address":"10.0.0.0","gateway":"","ipv6":false,"metric":-1,"net30":false,"prefix_length":24},{"address":"172.16.16.0","gateway":"","ipv6":false,"metric":-1,"net30":false,"prefix_length":24},{"address":"192.168.88.0","gateway":"","ipv6":false,"metric":-1,"net30":false,"prefix_length":23},{"address":"10.30.0.0","gateway":"","ipv6":false,"metric":-1,"net30":false,"prefix_length":16}],"block_ipv6":false,"block_outside_dns":false,"dns_options":{"servers":{}},"dns_servers":[{"address":"223.5.5.5","ipv6":false},{"address":"223.6.6.6","ipv6":false}],"layer":3,"mtu":0,"remote_address":{"address":"117.88.226.24","ipv6":false},"reroute_gw":{"flags":256,"ipv4":false,"ipv6":false},"route_metric_default":-1,"session_name":"xxx.com","tunnel_address_index_ipv4":0,"tunnel_address_index_ipv6":-1,"tunnel_addresses":[{"address":"172.20.0.237","gateway":"172.20.0.254","ipv6":false,"metric":-1,"net30":false,"prefix_length":24}]},"tun_type":0}POST np://[\\.\pipe\agent_ovpnconnect]/tun-setup : 200 OKTAP ADAPTERS:guid='{7989DA32-F7F6-431A-9286-645B175147BC}'index=10name='本地连接'OpenTAP device"本地连接"PATH="\\.\Global\{7989DA32-F7F6-431A-9286-645B175147BC}.tap"SUCCEEDED
TAP-WindowsDriverVersion9.27ActionDeleteAllRoutesOnInterfaceiface_index=10netshinterfaceipsetinterface10metric=9000确定。netshinterfaceipsetaddress10static172.20.0.237255.255.255.0gateway=172.20.0.254store=activeIPHelper:addroute10.0.0.0/2410172.20.0.254metric=-1IPHelper:addroute172.16.16.0/2410172.20.0.254metric=-1IPHelper:addroute192.168.88.0/2310172.20.0.254metric=-1IPHelper:addroute10.30.0.0/1610172.20.0.254metric=-1netshinterfaceipsetdnsservers10static223.5.5.5register=primary validate=nonetshinterfaceipadddnsservers10223.6.6.62validate=noNRPT::ActionCreatepid=[5700]domains=[]dns_servers=[223.5.5.5,223.6.6.6]dnssec=[0]id=[OpenVPNDNSRouting-5700]DNS::ActionApply:successfulActionBaseopenvpn_app_path=C:\ProgramFiles\OpenVPNConnect\OpenVPNConnect.exe tap_index=10enable=1permitIPv4requestsfromOpenVPNapp
permitIPv6requestsfromOpenVPNapp
blockIPv4requestsfromother apps
blockIPv6requestsfromother apps
allowIPv4trafficfromTAP
allowIPv6trafficfromTAP
blockIPv4DNS requests to loopbackfromother apps
blockIPv6DNS requests to loopbackfromother apps
ipconfig/flushdnsWindowsIP配置已成功刷新DNS解析缓存。TAP:ARP flush succeeded
TAP handle:f412000000000000⏎[Jan20,2025,16:22:21]Connectedvia TUN_WIN⏎[Jan20,2025,16:22:21]EVENT:CONNECTED user1@xxx.com:1194(117.88.226.24)via/TCPv4on TUN_WIN/172.20.0.237/gw=[172.20.0.254/]mtu=(default)⏎[Jan20,2025,16:22:26]Sessioninvalidated:DECRYPT_ERROR⏎[Jan20,2025,16:22:26]Clientterminated,restartingin2000ms...⏎[Jan20,2025,16:22:26]SetupClient:signaling tun destroyevent⏎[Jan20,2025,16:22:28]EVENT:RECONNECTING⏎[Jan20,2025,16:22:28]EVENT:RESOLVE⏎[Jan20,2025,16:22:28]EVENT:WAIT⏎[Jan20,2025,16:22:28]WinCommandAgent:transmitting bypass route to117.88.226.24{"host":"117.88.226.24","ipv6":false}⏎[Jan20,2025,16:22:28]Connectingto[xxx.com]:1194(117.88.226.24)viaTCPv4⏎[Jan20,2025,16:22:28]EVENT:CONNECTING⏎[Jan20,2025,16:22:28]TunnelOptions:V4,dev-type tun,link-mtu1523,tun-mtu1500,protoTCPv4_CLIENT,cipher AES-256-GCM,auth[null-digest],keysize256,key-method2,tls-client⏎[Jan20,2025,16:22:28]Creds:UsernameSessionId/PasswordEmpty⏎[Jan20,2025,16:22:28]TransportError:missing password⏎[Jan20,2025,16:22:28]EVENT:NEED_CREDS⏎[Jan20,2025,16:22:28]EVENT:DISCONNECTED⏎

---
```

## Response 1
Same problem when connecting an Android phone using OpenVPN Connect 3.5.1.This started when updating to RouterOS v7.17.1, in version 7.16.2 this did not occur.I tested it in version 7.17.1 using OpenVPN in UDP and the error does not occur, I still need a solution to make it work in v7.17.1 in TCP ---