---
title: Thread-213479
url: https://forum.mikrotik.com/viewtopic.php?t=213479&sid=49f92a630bc7970d8ca50523be880e8f
thread_id: 213479
section: RouterOS
post_count: 8
date_crawled: 2025-02-03T21:16:40.972233
---

### Post 1
Author: Unknown
Date: Unknown

Hello my friends,Merry Christmas to all of you, and I hope you have a great weekend..!I have the following scenario:I have MikroTik CCR2004 with two WAN connections:WAN-1 connected to Ether-1 from ONU-1WAN-2 connected to Ether-13 from ONU-2For WAN-1, I have two public IP addresses, and I am using both of them. I assigned the IPs as follows:ether-1 = xxx.xx.xx.85ether-1 = xxx.xx.xx.84I have also assigned SRC NAT rules for both IPs to the following two bridges that use this IPsBridge-1 = 192.168.0.1/24Bridge-2 = 10.0.0.0/24For WAN-2, I have also two public IP addresses, but I am using only one of them:ether-13 = xxx.xx.xx.123I have assigned a SRC NAT rule for the following bridge and I want it to use this public IP.Bridge-3 = 172.16.0.1/24All public IPs in WAN -1- and WAN -2- have the same gateway.The problem is that I am unable to get Bridge-3 subnet to connect to the internet.You can see the configuration file for more details.

---
### Post 2
Author: Unknown
Date: Unknown

Merry Christmas to you too! I have only skimmed your configuration but I think the problem is that you have used a routing rule for scr-address 172.16.0.0/24 which looks ONLY at the Server 2 routing table ("action=lookup-only-in-table"). Problem is there is no route configured for Server 2 routing table so nothing is basically reachable.

---
### Post 3
Author: Unknown
Date: Unknown

Merry Christmas to you too! I have only skimmed your configuration but I think the problem is that you have used a routing rule for scr-address 172.16.0.0/24 which looks ONLY at the Server 2 routing table ("action=lookup-only-in-table"). Problem is there is no route configured for Server 2 routing table so nothing is basically reachable.Hello, my friend!Thank you for your attention. No, there is a route configuration for Server 2, but I changed the name in the file above. Now I’ve corrected the name as it should be.My problem was that I forgot to add ether13 to the WAN address list table. However, I still have an issue: I am not sure if all the other traffic from Bridge 1 and Bridge 2 is also using ether13, which I don’t want to happen.

---
### Post 4
Author: Unknown
Date: Unknown

It shouldn't but this is easy to check anyway. Hook up a pc and issue traceroute or tracert and check the hops. Or simpler, go a browser and type what is my ip address. You should see different public ip addresses when connecting to different bridges. For example, when using bridge x it shows x.x.x.x and when using bridge y it shows y.y.y.y or whatever. This means the traffic goes out a different interface

---
### Post 5
Author: Unknown
Date: Unknown

First thing. check your configuration, whenever there is a "*" (asterisk followed by a (hex) number, it is a reference to *something* that was deleted/moved/renamed and that RoS cannot find anymore, it is a placeholder for something that was there but doesn't exist anymore:/interface list memberadd interface=ether1 list=WANadd interface=bridge1-Wifi list=LANadd interface=*16 list=LANadd interface=macvlan1 list=WANadd interface=wireguard1 list=LANadd interface="bridge2-Server -1-" list=LANadd interface="bridge3-Server -2-" list=LAN/ip routeadd disabled=yes distance=1 dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 \pref-src="" routing-table="ERP Server" scope=30 suppress-hw-offload=no \target-scope=10add disabled=yes distance=1 dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 \pref-src="" routing-table=Wifi scope=30 suppress-hw-offload=no \target-scope=10add disabled=no dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 routing-table=main \suppress-hw-offload=noadd disabled=yes distance=1 dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 \pref-src="" routing-table=*2 scope=30 suppress-hw-offload=no \target-scope=10add disabled=no distance=1 dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 \pref-src="" routing-table="Manifest Server" scope=30 suppress-hw-offload=\no target-scope=10add disabled=yes distance=1 dst-address=0.0.0.0/0 gateway=172.16.0.1 \pref-src="" routing-table=main scope=30 suppress-hw-offload=no \target-scope=10Then, a few semi-random notes:ether13 is not in interface-list LAN or WAN.your way of naming things is confusing, personally I would call things in the same order, and - if possible - avoid spaces (as they imply the use of double quotes, and this before or later will bite you back when using CLI), these:/interface bridgeadd name=bridge1-Wifiadd name="bridge2-Server -1-add name="bridge3-Server -2-miss closing quotes.and these are NOT valid:add bridge="bridge2-Server -1-ERP" interface=ether7add bridge="bridge2-Server -1-ERP" interface=ether8I would rename them:bridge1-Wifi ->bridge_Wifi_0"bridge2-Server -1-" -> bridge_Server_1"bridge3-Server -2-" -> bridge_Server_2Your routes and routing tables/rules are a mess because they make reference to fib's that either do not exist or are empty.Here again, be consistent in naming, *like*:/routing tableadd disabled=no fib name="Server 1 "-> Table_Server_1add disabled=no fib name=Wifi-> Table_Wifi_0add disabled=no fib name="Server 2 "-> Table_Server_2

---
### Post 6
Author: Unknown
Date: Unknown

First thing. check your configuration, whenever there is a "*" (asterisk followed by a (hex) number, it is a reference to *something* that was deleted/moved/renamed and that RoS cannot find anymore, it is a placeholder for something that was there but doesn't exist anymore:/interface list memberadd interface=ether1 list=WANadd interface=bridge1-Wifi list=LANadd interface=*16 list=LANadd interface=macvlan1 list=WANadd interface=wireguard1 list=LANadd interface="bridge2-Server -1-" list=LANadd interface="bridge3-Server -2-" list=LAN/ip routeadd disabled=yes distance=1 dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 \pref-src="" routing-table="ERP Server" scope=30 suppress-hw-offload=no \target-scope=10add disabled=yes distance=1 dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 \pref-src="" routing-table=Wifi scope=30 suppress-hw-offload=no \target-scope=10add disabled=no dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 routing-table=main \suppress-hw-offload=noadd disabled=yes distance=1 dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 \pref-src="" routing-table=*2 scope=30 suppress-hw-offload=no \target-scope=10add disabled=no distance=1 dst-address=0.0.0.0/0 gateway=xxx.xx.xx.1 \pref-src="" routing-table="Manifest Server" scope=30 suppress-hw-offload=\no target-scope=10add disabled=yes distance=1 dst-address=0.0.0.0/0 gateway=172.16.0.1 \pref-src="" routing-table=main scope=30 suppress-hw-offload=no \target-scope=10Then, a few semi-random notes:ether13 is not in interface-list LAN or WAN.your way of naming things is confusing, personally I would call things in the same order, and - if possible - avoid spaces (as they imply the use of double quotes, and this before or later will bite you back when using CLI), these:/interface bridgeadd name=bridge1-Wifiadd name="bridge2-Server -1-add name="bridge3-Server -2-miss closing quotes.and these are NOT valid:add bridge="bridge2-Server -1-ERP" interface=ether7add bridge="bridge2-Server -1-ERP" interface=ether8I would rename them:bridge1-Wifi ->bridge_Wifi_0"bridge2-Server -1-" -> bridge_Server_1"bridge3-Server -2-" -> bridge_Server_2Your routes and routing tables/rules are a mess because they make reference to fib's that either do not exist or are empty.Here again, be consistent in naming, *like*:/routing tableadd disabled=no fib name="Server 1 "-> Table_Server_1add disabled=no fib name=Wifi-> Table_Wifi_0add disabled=no fib name="Server 2 "-> Table_Server_2Thank you for your advice jaclaz. I have changed the real names of all my interfaces, routing tables, and rules for security reasons, as they refer to actual server names. That’s why you see "ERP" and "Manifest" used as placeholders. Despite that, my focus remains on the main configuration.My current issue is: how can I ensure that Bridge 1 and Bridge 2 exclusively use the WAN-1 bandwidth and route, while Bridge 3 exclusively uses the WAN-2 bandwidth and route?

---
### Post 7
Author: Unknown
Date: Unknown

It seems to me you were already on the right track:1) add a dedicated routing table2) add a route/gateway on that routing table for the intended gateway3) add a routing rule filtering the source address range and making use of that router tableLoosely, if it was 3 times 1:1, it would be something *like*:Code:Select all/routing tableadddisabled=nofib name=table1adddisabled=nofib name=table2adddisabled=nofib name=table3/ip addressaddaddress=172.16.1.1/24interface="bridge1"addaddress=172.16.2.1/24interface="bridge2"addaddress=172.16.3.1/24interface="bridge3"/ip routeadddistance=1dst-address=0.0.0.0/0gateway=xxx.xx.xx.1routing-table=table1adddistance=1dst-address=0.0.0.0/0gateway=xxx.xx.xx.1routing-table=table2adddistance=1dst-address=0.0.0.0/0gateway=xxx.xx.xx.1routing-table=table3/routing ruleaddaction=lookup-only-in-table src-address=172.16.1.1/24table=table1addaction=lookup-only-in-table src-address=172.16.2.1/24table=table2addaction=lookup-only-in-table src-address=172.16.3.1/24table=table3Assuming that you can choose LAN addresses and have bridge1 and bridge2 in two contiguous subnets, you can instead use a /23 in routing rule and have only two tables, I would try something *like*:Code:Select all/routing tableadddisabled=nofib name=table1-2adddisabled=nofib name=table3/ip addressaddaddress=172.16.1.1/24interface="bridge1"addaddress=172.16.2.1/24interface="bridge2"addaddress=172.16.3.1/24interface="bridge3"/ip routeadddistance=1dst-address=0.0.0.0/0gateway=xxx.xx.xx.1routing-table=table1-2adddistance=1dst-address=0.0.0.0/0gateway=xxx.xx.xx.1routing-table=table3/routing ruleaddaction=lookup-only-in-table src-address=172.16.1.1/23table=table1-2addaction=lookup-only-in-table src-address=172.16.3.1/24table=table3

---
### Post 8
Author: Unknown
Date: Unknown

All public IPs in WAN -1- and WAN -2- have the same gateway.I will soon ask some questions here as I am actively searching for a similar goal. In my case, I think I need to tinker more with the routes, and I will use yours now as inspiration, but I have the same "problem" as you. The public IPs WANs are from the same ISP and have the same gateway. Mine are even PPoEs so even with profiles I end up not being able to select gateway, which is a generic 10.0.0.1.Disabling one or another PPOEs solves the routes I have in place but my goal actually is to separate (isolate if possible) 1 ISP1 + 1 bridge1 + 1 DHCP1 from the other 1 ISP2 + 1 bridge2 + 1 DHCP2, no load balancing, no failover, trying to keep it very simple.Having the same ISPs gateway can be your problem too.Kind regards,Paul

---
