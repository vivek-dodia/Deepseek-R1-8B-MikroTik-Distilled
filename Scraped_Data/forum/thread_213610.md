---
title: Untitled Thread
source_url: https://forum.mikrotik.com/viewtopic.php?f=2&t=213610&p=1117216&amp;sid=3b77a3334c914448dbbc02bfdff4c3aa#p1117216
crawled_date: 2025-02-02T22:02:34.596726
section: mikrotik_forum
type: forum_thread
---

### Author: Tue Dec 31, 2024 4:38 pm
Date: Unknown

```
Code:Select allname="ike2-proposal"auth-algorithms=sha512,sha256
      enc-algorithms=chacha20poly1305,aes-256-cbc,aes-256-ctr,aes-256-gcm
      lifetime=30mpfs-group=modp2048

name="ike2"hash-algorithm=sha256 enc-algorithm=aes-256dh-group=x25519,ecp256,ecp384,ecp521,modp8192,modp6144,modp4096,modp3072,modp2048
     lifetime=1dproposal-check=obey nat-traversal=yes
     dpd-interval=disable-dpd
```

```
Code:Select all15:13:08ipsec,info killing ike2 SA:ipsec_peer1 remote_ipv6_address[4500]-laptop_ipv6_address[4500]spi:5749e2dbc237181a:fba7b0f7cfc9e79715:13:08ipsec,info releasing address10.z.x.y
```

Anyone having trouble with the built-in VPN client in macOS Sequoia 15.2? For some unknown reason, the VPN disconnects in 8 minutes, but it only happens with macOS client (it works perfectly with IOS client). The logs on Mikrotik do not contain any useful information why it gets disconnected. Here are the phase1-2 configs:This is what I see in the logs:2 questions:Anyone knows how to configure ipsec logging to have more meaningful information? Setting up ipsec,debug,!packet includes lots of hexadecimal sorcery but no useful informationAnyone has this working and would share their settings for proposal & profile?


---
### Author: Tue Dec 31, 2024 7:08 pm
Date: Unknown

Anyone knows how to configure ipsec logging to have more meaningful information? Setting up ipsec,debug,!packet includes lots of hexadecimal sorcery but no useful informationScattered among the "hexadecimal sorcery" is actually a lot of useful information, just ignore the  rows with the hex and read the rest.Anyone has this working and would share their settings for proposal & profile?It used to be 24 minutes, maybe Apple has further shortened the time?viewtopic.php?t=205790I had to create a dedicated proposal and configure the Apple clients to use responder ID (I don't remember the field name in the iOS form though):/ip ipsec proposaladd auth-algorithms="" enc-algorithms=aes-256-gcmlifetime=23m19sname=apple pfs-group=ecp256/ip ipsec policy groupadd name=apple/ip ipsec policyadd group=apple proposal=apple template=yes/ip ipsec identityadd auth-method=eap-radius certificate=letsencrypt-autogen_2024-10-24T00:35:26Z,LetsEncryptR11 generate-policy=port-strict mode-config=applemy-id=fqdn:apple.incpeer=ike2-responder policy-template-group=apple


---
### Author: Wed Jan 01, 2025 3:04 pm
Date: Unknown

Thanks but you seem to be using EC certificates not RSA no? I can try reducing the lifetime length to see if that does the trick but for me it’s always exactly 8 minutes.Do you know how to see in the logs which algorithm was chosen by the client?I tried it with 7m lifetime but it still disconnected, however now I see this in the logs: ipsec,error IPsec-SA expired before finishing rekey:


---
### Author: Wed Jan 01, 2025 3:36 pm
Date: Unknown

I'm not an iOS specialist so I have no clue whether the type of certificate (which is only used in Phase 1) affects the parameters for Phase 2, but Mikrotik only requests RSA certificates from Let's Encrypt.For me it was also exactly 24 minutes until I've implemented that workaround where Mikrotik initiates the rekeying before the iOS client.In the logs you can see all the transforms the client proposes for both Phase 1 and Phase 2 - since iOS is the initiator (client), it proposes and the Mikrotik chooses. In the log, it looks as follows for Phase 1:14:32:27 ipsec IKE Protocol: IKE14:32:27 ipsec  proposal #114:32:27 ipsec   enc: 3des-cbc14:32:27 ipsec   prf: hmac-sha114:32:27 ipsec   auth: sha114:32:27 ipsec   dh: modp102414:32:27 ipsec  proposal #214:32:27 ipsec   enc: aes256-cbc14:32:27 ipsec   prf: hmac-sha114:32:27 ipsec   auth: sha114:32:27 ipsec   dh: modp102414:32:27 ipsec  proposal #314:32:27 ipsec   enc: 3des-cbc14:32:27 ipsec   prf: hmac-sha25614:32:27 ipsec   auth: sha25614:32:27 ipsec   dh: modp1024...and later, you can find similar rows for Phase 2:14:32:28 ipsec processing payload: SA14:32:28 ipsec IKE Protocol: ESP14:32:28 ipsec  proposal #114:32:28 ipsec   enc: aes256-cbc14:32:28 ipsec   auth: sha114:32:28 ipsec  proposal #214:32:28 ipsec   enc: 3des-cbc14:32:28 ipsec   auth: sha1...


---
### Author: Wed Jan 01, 2025 11:29 pm
Date: Unknown

Thanks, so what you have just shared is not what I see in the logs - can you please confirm your log settings? I have ipsec, debug, !packet but I see nothing like what you have shared in your post.Also, the client here is macOS not IOS (IOS clients work without any problems, only macOS disconnects) and I’m using my own CA (outside Mikrotik) to generate certificates, but was under the impression that you can only use the ec DH groups with ec certificates and that’s what I wanted to confirm, but I don’t think the problem will be with the certificates but rather with the settings.


---
### Author: Thu Jan 02, 2025 1:58 pm
Date: Unknown

Sorrry for messing up iOS and MacOS, I'm even not sure which one of those had the 24-minute issue in my case.As for the need to use EC-based DH-groups if you use an EC certificate, I know this to be an issue with Windows, but I have never encountered that anywhere else - as you can see from the above, even the Apple device exhibiting the 24-minute issue doesn't have any trouble accepting a RSA certificate and then using an EC-based PFS algorithm.I normally usetopics=ipsec,!packetwithout thedebugso maybe that's the reason - in the rows I posted, thedebugattribute is not shown.


---
### Author: Thu Jan 02, 2025 4:04 pm
Date: Unknown

```
Code:Select all11:13:28ipsec ipsecdebug:processing payload:SA11:13:28ipsec ipsecdebug:IKEProtocol:IKE11:13:28ipsec ipsecdebug:proposal#111:13:28ipsec ipsecdebug:enc:aes256-cbc11:13:28ipsec ipsecdebug:prf:hmac-sha25611:13:28ipsec ipsecdebug:auth:sha25611:13:28ipsec ipsecdebug:dh:modp204811:13:28ipsec ipsecdebug:proposal#211:13:28ipsec ipsecdebug:enc:aes256-cbc11:13:28ipsec ipsecdebug:prf:hmac-sha25611:13:28ipsec ipsecdebug:auth:sha25611:13:28ipsec ipsecdebug:dh:ecp25611:13:28ipsec ipsecdebug:proposal#311:13:28ipsec ipsecdebug:enc:aes256-cbc11:13:28ipsec ipsecdebug:prf:hmac-sha25611:13:28ipsec ipsecdebug:auth:sha25611:13:28ipsec ipsecdebug:dh:modp153611:13:28ipsec ipsecdebug:proposal#411:13:28ipsec ipsecdebug:enc:aes128-cbc11:13:28ipsec ipsecdebug:prf:hmac-sha111:13:28ipsec ipsecdebug:auth:sha111:13:28ipsec ipsecdebug:dh:modp102411:13:28ipsec ipsecdebug:proposal#511:13:28ipsec ipsecdebug:enc:3des-cbc11:13:28ipsec ipsecdebug:prf:hmac-sha111:13:28ipsec ipsecdebug:auth:sha111:13:28ipsec ipsecdebug:dh:modp102411:13:28ipsec ipsecdebug:matched proposal:11:13:28ipsec ipsecdebug:proposal#111:13:28ipsec ipsecdebug:enc:aes256-cbc11:13:28ipsec ipsecdebug:prf:hmac-sha25611:13:28ipsec ipsecdebug:auth:sha25611:13:28ipsec ipsecdebug:dh:modp204811:13:28ipsec ipsecdebug:processing payload:KE--snip---11:13:28ipsec ipsecdebug:IKEProtocol:ESP11:13:28ipsec ipsecdebug:proposal#111:13:28ipsec ipsecdebug:enc:aes256-cbc11:13:28ipsec ipsecdebug:auth:sha25611:13:28ipsec ipsecdebug:proposal#211:13:28ipsec ipsecdebug:enc:aes128-cbc11:13:28ipsec ipsecdebug:auth:sha111:13:28ipsec ipsecdebug:proposal#311:13:28ipsec ipsecdebug:enc:3des-cbc11:13:28ipsec ipsecdebug:auth:sha111:13:28ipsec ipsecdebug:processing payload:TS_I11:13:28ipsec ipsecdebug:0.0.0.0/011:13:28ipsec ipsecdebug:[::/0]11:13:28ipsec ipsecdebug:processing payload:TS_R11:13:28ipsec ipsecdebug:0.0.0.0/011:13:28ipsec ipsecdebug:[::/0]11:13:28ipsec ipsecdebug:TSiintunnel mode replacedwithconfig address:10.x.y.z11:13:28ipsec ipsecdebug:TSrintunnel mode replacedwithsplit subnet:0.0.0.0/011:13:28ipsec ipsecdebug:candidate selectors:0.0.0.0/0<=>10.x.y.z11:13:28ipsec ipsecdebug:candidate selectors:[::/0]<=>[::/0]11:13:28ipsec ipsecdebug:searchingforpolicyforselector:0.0.0.0/0<=>10.x.y.z11:13:28ipsec ipsecdebug:generating policy11:13:28ipsec ipsecdebug:matched proposal:11:13:28ipsec ipsecdebug:proposal#111:13:28ipsec ipsecdebug:enc:aes256-cbc11:13:28ipsec ipsecdebug:auth:sha25611:13:28ipsec ipsecdebug:ike auth:finish8minutespass11:21:28ipsec ipsecdebug:IKE SA rekey11:21:28ipsec ipsecdebug:processing payload:SA11:21:28ipsec ipsecdebug:IKEProtocol:IKE11:21:28ipsec ipsecdebug:proposal#111:21:28ipsec ipsecdebug:enc:aes256-cbc11:21:28ipsec ipsecdebug:prf:hmac-sha25611:21:28ipsec ipsecdebug:auth:sha25611:21:28ipsec ipsecdebug:dh:modp204811:21:28ipsec ipsecdebug:matched proposal:11:21:28ipsec ipsecdebug:proposal#111:21:28ipsec ipsecdebug:enc:aes256-cbc11:21:28ipsec ipsecdebug:prf:hmac-sha25611:21:28ipsec ipsecdebug:auth:sha25611:21:28ipsec ipsecdebug:dh:modp204811:21:28ipsec ipsecdebug:processing payload:KE11:21:28ipsec ipsecdebug:processing payload:NONCE11:21:28ipsec ipsecdebug:adding payload:SA11:21:28ipsec ipsecdebug:adding payload:KE11:21:28ipsec ipsecdebug:adding payload:NONCE11:21:28ipsec ipsecdebug:<-ike2 reply,exchange:CREATE_CHILD_SA:2client_ipv6_address[4500]5075bb554b1b4b8f:5aae9a769e4febaa11:21:28ipsec ipsecdebug:->ike2 request,exchange:INFORMATIONAL:3client_ipv6_address[4500]5075bb554b1b4b8f:5aae9a769e4febaa11:21:28ipsec ipsecdebug:payload seen:ENC11:21:28ipsec ipsecdebug:processing payload:ENC11:21:28ipsec ipsecdebug:payload seen:DELETE11:21:28ipsec ipsecdebug:respond:info11:21:28ipsec ipsecdebug:processing payloads:NOTIFY(none found)11:21:28ipsec ipsecdebug:<-ike2 reply,exchange:INFORMATIONAL:3client_ipv6_address[4500]5075bb554b1b4b8f:5aae9a769e4febaa11:21:28ipsec ipsecdebug:processing payloads:DELETE11:21:28ipsec ipsecdebug:deleteIKE SA11:21:28ipsec ipsecdebug:rekeydone11:21:28ipsec ipsecdebug:->ike2 request,exchange:CREATE_CHILD_SA:0client_ipv6_address[4500]cc797dcb76722b2f:8cdbef8c0100ebba11:21:28ipsec ipsecdebug:payload seen:ENC11:21:28ipsec ipsecdebug:processing payload:ENC11:21:28ipsec ipsecdebug:payload seen:NOTIFY11:21:28ipsec ipsecdebug:payload seen:SA11:21:28ipsec ipsecdebug:payload seen:NONCE11:21:28ipsec ipsecdebug:payload seen:TS_I11:21:28ipsec ipsecdebug:payload seen:TS_R11:21:28ipsec ipsecdebug:create child:respond11:21:28ipsec ipsecdebug:processing payloads:NOTIFY11:21:28ipsec ipsecdebug:notify:REKEY_SA11:21:28ipsec ipsecdebug:rekeying child SA0xafc156711:21:28ipsec ipsecdebug:peer wants tunnel mode11:21:28ipsec ipsecdebug:processing payload:TS_R11:21:28ipsec ipsecdebug:0.0.0.0/011:21:28ipsec ipsecdebug:processing payload:TS_I11:21:28ipsec ipsecdebug:10.x.y.z11:21:28ipsec ipsecdebug:checking:0.0.0.0/0<=>10.x.y.z11:21:28ipsec ipsecdebug:processing payload:SA11:21:28ipsec ipsecdebug:IKEProtocol:ESP11:21:28ipsec ipsecdebug:proposal#111:21:28ipsec ipsecdebug:enc:aes256-cbc11:21:28ipsec ipsecdebug:auth:sha25611:21:28ipsec ipsecdebug:reply notify:NO_PROPOSAL_CHOSEN11:21:28ipsec ipsecdebug:adding notify:NO_PROPOSAL_CHOSEN11:21:28ipsec ipsecdebug:<-ike2 reply,exchange:CREATE_CHILD_SA:0client_ipv6_address[4500]cc797dcb76722b2f:8cdbef8c0100ebba11:21:28ipsec ipsecdebug:->ike2 request,exchange:INFORMATIONAL:1client_ipv6_address[4500]cc797dcb76722b2f:8cdbef8c0100ebba11:21:28ipsec ipsecdebug:payload seen:ENC11:21:28ipsec ipsecdebug:processing payload:ENC11:21:28ipsec ipsecdebug:payload seen:DELETE11:21:28ipsec ipsecdebug:respond:info11:21:28ipsec ipsecdebug:processing payloads:NOTIFY(none found)11:21:28ipsec ipsecdebug:<-ike2 reply,exchange:INFORMATIONAL:1client_ipv6_address[4500]cc797dcb76722b2f:8cdbef8c0100ebba11:21:28ipsec ipsecdebug:processing payloads:DELETE11:21:28ipsec ipsecdebug:deleteESP SA11:21:28ipsec ipsecdebug:deletespi:0xafc156711:21:28ipsec ipsecdebug:IPsec-SA killing:client_ipv6_address[4500]->mikrotik_ipv6_address[4500]spi=0xd4cc08d11:21:28ipsec ipsecdebug:IPsec-SA killing:mikrotik_ipv6_address[4500]->client_ipv6_address[4500]spi=0xafc156711:21:28ipsec ipsecdebug:removing generated policy11:21:28ipsec ipsecdebug:->ike2 request,exchange:INFORMATIONAL:2client_ipv6_address[4500]cc797dcb76722b2f:8cdbef8c0100ebba11:21:28ipsec ipsecdebug:payload seen:ENC11:21:28ipsec ipsecdebug:processing payload:ENC11:21:28ipsec ipsecdebug:payload seen:DELETE11:21:28ipsec ipsecdebug:respond:info11:21:28ipsec ipsecdebug:processing payloads:NOTIFY(none found)11:21:28ipsec ipsecdebug:<-ike2 reply,exchange:INFORMATIONAL:2client_ipv6_address[4500]cc797dcb76722b2f:8cdbef8c0100ebba11:21:28ipsec ipsecdebug:processing payloads:DELETE11:21:28ipsec ipsecdebug:deleteIKE SA11:21:28ipsec,info killing ike2 SA:ipsec_peer1 mikrotik_ipv6_address[4500]-client_ipv6_address[4500]spi:8cdbef8c0100ebba:cc797dcb76722b2f11:21:28ipsec,info ipsecdebug:killing ike2 SA:ipsec_peer1 mikrotik_ipv6_address[4500]-client_ipv6_address[4500]spi:8cdbef8c0100ebba:cc797dcb76722b2f11:21:28ipsec,info releasing address10.x.y.z
```

Thanks, with those log settings I was able to learn more of the problem, it seems there is only 1 proposal for rekeying and for some reason, the macOS client does not choose that.


---
### Author: [SOLVED]Thu Jan 02, 2025 4:16 pm
Date: Unknown

The rekey proposal comes from the MacOS, Mikrotik accepts it, and the MacOS sends DELETE nevertheless. It looks very similar to the 24-minute behavior, maybe the SA lifetime is 3 times shorter for IPv6? So try limiting the lifetime to 7m49s at Mikrotik side so that it would initiate the rekeying process before the Mac can and see whether that helps.


---
### Author: Thu Jan 02, 2025 5:17 pm
Date: Unknown

I read it differently, Mikrotik offers only 1 proposal and macOS does not choose that. I tried reducing the lifetime to 2 minutes and it got disconnected after 2 minutes, however, removing the DH group from the proposal seem to have fixed it and it's been connected for some time now, however it again disconected after 8 minutes when I increased the lifetime back to 30 minutes.


---
### Author: Thu Jan 02, 2025 5:52 pm
Date: Unknown

processing payloadnormally means that the packet carrying the payload came from the other peer, can you double-check that on the few rows just before the11:21:28 ipsec ipsecdebug: IKE SA rekey11:21:28 ipsec ipsecdebug: processing payload: SAones?Other than that, can you show me the log from the case when the Tik initiates the rekey?


---
### Author: Thu Jan 02, 2025 6:13 pm
Date: Unknown

```
Code:Select allname="ike2"hash-algorithm=sha256 prf-algorithm=sha256 enc-algorithm=aes-256dh-group=modp2048 lifetime=1dproposal-check=obey nat-traversal=yes dpd-interval=2mdpd-maximum-failures=3
```

```
Code:Select allname="ike2-proposal"auth-algorithms=sha256 enc-algorithms=aes-256-cbc lifetime=30mpfs-group=none
```

```
Code:Select all16:54:36ipsec ipsecdebug:->ike2 request,exchange:SA_INIT:0laptop_ipv6_address[500]19daf5dfb3e01030:000000000000000016:54:36ipsec ipsecdebug:ike2 respond16:54:36ipsec ipsecdebug:payload seen:SA16:54:36ipsec ipsecdebug:payload seen:KE16:54:36ipsec ipsecdebug:payload seen:NONCE16:54:36ipsec ipsecdebug:payload seen:NOTIFY16:54:36ipsec ipsecdebug:payload seen:NOTIFY16:54:36ipsec ipsecdebug:payload seen:NOTIFY16:54:36ipsec ipsecdebug:payload seen:NOTIFY16:54:36ipsec ipsecdebug:payload seen:NOTIFY16:54:36ipsec ipsecdebug:processing payload:SA16:54:36ipsec ipsecdebug:IKEProtocol:IKE16:54:36ipsec ipsecdebug:proposal#116:54:36ipsec ipsecdebug:enc:aes256-cbc16:54:36ipsec ipsecdebug:prf:hmac-sha25616:54:36ipsec ipsecdebug:auth:sha25616:54:36ipsec ipsecdebug:dh:modp204816:54:36ipsec ipsecdebug:proposal#216:54:36ipsec ipsecdebug:enc:aes256-cbc16:54:36ipsec ipsecdebug:prf:hmac-sha25616:54:36ipsec ipsecdebug:auth:sha25616:54:36ipsec ipsecdebug:dh:ecp25616:54:36ipsec ipsecdebug:proposal#316:54:36ipsec ipsecdebug:enc:aes256-cbc16:54:36ipsec ipsecdebug:prf:hmac-sha25616:54:36ipsec ipsecdebug:auth:sha25616:54:36ipsec ipsecdebug:dh:modp153616:54:36ipsec ipsecdebug:proposal#416:54:36ipsec ipsecdebug:enc:aes128-cbc16:54:36ipsec ipsecdebug:prf:hmac-sha116:54:36ipsec ipsecdebug:auth:sha116:54:36ipsec ipsecdebug:dh:modp102416:54:36ipsec ipsecdebug:proposal#516:54:36ipsec ipsecdebug:enc:3des-cbc16:54:36ipsec ipsecdebug:prf:hmac-sha116:54:36ipsec ipsecdebug:auth:sha116:54:36ipsec ipsecdebug:dh:modp102416:54:36ipsec ipsecdebug:matched proposal:16:54:36ipsec ipsecdebug:proposal#116:54:36ipsec ipsecdebug:enc:aes256-cbc16:54:36ipsec ipsecdebug:prf:hmac-sha25616:54:36ipsec ipsecdebug:auth:sha25616:54:36ipsec ipsecdebug:dh:modp204816:54:36ipsec ipsecdebug:processing payload:KE16:54:36ipsec ipsecdebug:ike2 respond finish:request,exchange:SA_INIT:0laptop_ipv6_address[500]19daf5dfb3e01030:000000000000000016:54:36ipsec ipsecdebug:processing payload:NONCE16:54:36ipsec ipsecdebug:adding payload:SA16:54:36ipsec ipsecdebug:adding payload:KE16:54:36ipsec ipsecdebug:adding payload:NONCE16:54:36ipsec ipsecdebug:adding notify:NAT_DETECTION_SOURCE_IP16:54:36ipsec ipsecdebug:adding notify:NAT_DETECTION_DESTINATION_IP16:54:36ipsec ipsecdebug:adding notify:IKEV2_FRAGMENTATION_SUPPORTED16:54:36ipsec ipsecdebug:adding payload:CERTREQ16:54:36ipsec ipsecdebug:<-ike2 reply,exchange:SA_INIT:0laptop_ipv6_address[500]19daf5dfb3e01030:7103e19a622b874616:54:36ipsec,infonewike2 SA(R):ipsec_peer1 mikrotik_ipv6_address[500]-laptop_ipv6_address[500]spi:7103e19a622b8746:19daf5dfb3e0103016:54:36ipsec,info ipsecdebug:newike2 SA(R):ipsec_peer1 mikrotik_ipv6_address[500]-laptop_ipv6_address[500]spi:7103e19a622b8746:19daf5dfb3e0103016:54:36ipsec ipsecdebug:processing payloads:VID(none found)16:54:36ipsec ipsecdebug:processing payloads:NOTIFY16:54:36ipsec ipsecdebug:notify:REDIRECT_SUPPORTED16:54:36ipsec ipsecdebug:notify:NAT_DETECTION_SOURCE_IP16:54:36ipsec ipsecdebug:notify:NAT_DETECTION_DESTINATION_IP16:54:36ipsec ipsecdebug:notify:IKEV2_FRAGMENTATION_SUPPORTED16:54:36ipsec ipsecdebug:notify:SIGNATURE_HASH_ALGORITHMS16:54:36ipsec ipsecdebug:fragmentation negotiated16:54:36ipsec ipsecdebug:->ike2 request,exchange:AUTH:1laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874616:54:36ipsec ipsecdebug:peer ports changed:500->450016:54:36ipsec ipsecdebug:payload seen:SKF16:54:36ipsec ipsecdebug:processing payload:ENC(notfound)16:54:36ipsec ipsecdebug:processing payload:SKF16:54:36ipsec ipsecdebug:->ike2 request,exchange:AUTH:1laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874616:54:36ipsec ipsecdebug:payload seen:SKF16:54:36ipsec ipsecdebug:processing payload:ENC(notfound)16:54:36ipsec ipsecdebug:processing payload:SKF16:54:36ipsec ipsecdebug:payload seen:ID_I16:54:36ipsec ipsecdebug:payload seen:CERT16:54:36ipsec ipsecdebug:payload seen:NOTIFY16:54:36ipsec ipsecdebug:payload seen:ID_R16:54:36ipsec ipsecdebug:payload seen:AUTH16:54:36ipsec ipsecdebug:payload seen:CONFIG16:54:36ipsec ipsecdebug:payload seen:NOTIFY16:54:36ipsec ipsecdebug:payload seen:NOTIFY16:54:36ipsec ipsecdebug:payload seen:SA16:54:36ipsec ipsecdebug:payload seen:TS_I16:54:36ipsec ipsecdebug:payload seen:TS_R16:54:36ipsec ipsecdebug:payload seen:NOTIFY16:54:36ipsec ipsecdebug:processing payloads:NOTIFY16:54:36ipsec ipsecdebug:notify:INITIAL_CONTACT16:54:36ipsec ipsecdebug:notify:ESP_TFC_PADDING_NOT_SUPPORTED16:54:36ipsec ipsecdebug:notify:NON_FIRST_FRAGMENTS_ALSO16:54:36ipsec ipsecdebug:notify:MOBIKE_SUPPORTED16:54:36ipsec ipsecdebug:ike auth:respond16:54:36ipsec ipsecdebug:processing payload:ID_I16:54:36ipsec ipsecdebug:ID_I(FQDN):hermes16:54:36ipsec ipsecdebug:processing payload:ID_R16:54:36ipsec ipsecdebug:ID_R(FQDN):styx16:54:36ipsec ipsecdebug:processing payload:AUTH16:54:36ipsec ipsecdebug:processing payload:CERT16:54:36ipsec ipsecdebug:Certificate:16:54:36ipsec ipsecdebug:serialNr:07:d1:14:05:58:46:4d:5d:f5:8d:3d:a9:95:1c:dd:c316:54:36ipsec ipsecdebug:issuer:<removed>16:54:36ipsec ipsecdebug:subject:<CN=hermes>16:54:36ipsec ipsecdebug:notBefore:FriOct721:23:12202216:54:36ipsec ipsecdebug:notAfter:MonOct421:23:12203216:54:36ipsec ipsecdebug:selfSigned:016:54:36ipsec ipsecdebug:extensions:16:54:36ipsec ipsecdebug:key usage:digital-signature16:54:36ipsec ipsecdebug:extended key usage:tls-client16:54:36ipsec ipsecdebug:basic constraints:isCa:FALSE16:54:36ipsec ipsecdebug:subject key id:9f:e6:a2:7a:c6:bc:94:bf:01:e5:6f:d6:56:35:31:70:18:ba:b9:b916:54:36ipsec ipsecdebug:authority key id:18:ba:6e:15:d0:4a:17:7a:16:5f:9d:86:22:53:74:34:ea:f1:48:5816:54:36ipsec ipsecdebug:subject alternative name:16:54:36ipsec ipsecdebug:DNS:hermes16:54:36ipsec ipsecdebug:signedwith:SHA256+RSA16:54:36ipsec ipsecdebug:[RSA-PUBLIC]16:54:36ipsec ipsecdebug:modulus:<removed>16:54:36ipsec ipsecdebug:publicExponent:1000116:54:36ipsec ipsecdebug:requested server id:styx16:54:36ipsec ipsecdebug:processing payloads:NOTIFY16:54:36ipsec ipsecdebug:notify:INITIAL_CONTACT16:54:36ipsec ipsecdebug:notify:ESP_TFC_PADDING_NOT_SUPPORTED16:54:36ipsec ipsecdebug:notify:NON_FIRST_FRAGMENTS_ALSO16:54:36ipsec ipsecdebug:notify:MOBIKE_SUPPORTED16:54:36ipsec ipsecdebug:processing payload:AUTH16:54:36ipsec ipsecdebug:requested auth method:RSA16:54:36ipsec ipsecdebug:trust chain:16:54:36ipsec ipsecdebug:0:SKID:9f:e6:a2:7a:c6:bc:94:bf:01:e5:6f:d6:56:35:31:70:18:ba:b9:b916:54:36ipsec ipsecdebug:AKID:18:ba:6e:15:d0:4a:17:7a:16:5f:9d:86:22:53:74:34:ea:f1:48:5816:54:36ipsec ipsecdebug:1:SKID:18:ba:6e:15:d0:4a:17:7a:16:5f:9d:86:22:53:74:34:ea:f1:48:5816:54:36ipsec ipsecdebug:AKID:18:ba:6e:15:d0:4a:17:7a:16:5f:9d:86:22:53:74:34:ea:f1:48:5816:54:36ipsec,info,account peer authorized:ipsec_peer1 mikrotik_ipv6_address[4500]-laptop_ipv6_address[4500]spi:7103e19a622b8746:19daf5dfb3e0103016:54:36ipsec,info,account ipsecdebug:peer authorized:ipsec_peer1 mikrotik_ipv6_address[4500]-laptop_ipv6_address[4500]spi:7103e19a622b8746:19daf5dfb3e0103016:54:36ipsec ipsecdebug:initial contact16:54:36ipsec ipsecdebug:processing payloads:NOTIFY16:54:36ipsec ipsecdebug:notify:INITIAL_CONTACT16:54:36ipsec ipsecdebug:notify:ESP_TFC_PADDING_NOT_SUPPORTED16:54:36ipsec ipsecdebug:notify:NON_FIRST_FRAGMENTS_ALSO16:54:36ipsec ipsecdebug:notify:MOBIKE_SUPPORTED16:54:36ipsec ipsecdebug:peer wants tunnel mode16:54:36ipsec ipsecdebug:processing payload:CONFIG16:54:36ipsec ipsecdebug:attribute:internalIPv4address16:54:36ipsec ipsecdebug:attribute:internalIPv4netmask16:54:36ipsec ipsecdebug:attribute:internalIPv4DHCP16:54:36ipsec ipsecdebug:attribute:internalIPv4DNS16:54:36ipsec ipsecdebug:attribute:internalIPv6address16:54:36ipsec ipsecdebug:attribute:internalIPv6DHCP16:54:36ipsec ipsecdebug:attribute:internalIPv6DNS16:54:36ipsec ipsecdebug:attribute:internalDNS domain16:54:36ipsec,info acquired10.x.y.z addressforlaptop_ipv6_address,hermes16:54:36ipsec,info ipsecdebug:acquired10.x.y.z addressforlaptop_ipv6_address,hermes16:54:36ipsec ipsecdebug:processing payload:SA16:54:36ipsec ipsecdebug:IKEProtocol:ESP16:54:36ipsec ipsecdebug:proposal#116:54:36ipsec ipsecdebug:enc:aes256-cbc16:54:36ipsec ipsecdebug:auth:sha25616:54:36ipsec ipsecdebug:proposal#216:54:36ipsec ipsecdebug:enc:aes128-cbc16:54:36ipsec ipsecdebug:auth:sha116:54:36ipsec ipsecdebug:proposal#316:54:36ipsec ipsecdebug:enc:3des-cbc16:54:36ipsec ipsecdebug:auth:sha116:54:36ipsec ipsecdebug:processing payload:TS_I16:54:36ipsec ipsecdebug:0.0.0.0/016:54:36ipsec ipsecdebug:[::/0]16:54:36ipsec ipsecdebug:processing payload:TS_R16:54:36ipsec ipsecdebug:0.0.0.0/016:54:36ipsec ipsecdebug:[::/0]16:54:36ipsec ipsecdebug:TSiintunnel mode replacedwithconfig address:10.x.y.z16:54:36ipsec ipsecdebug:TSrintunnel mode replacedwithsplit subnet:0.0.0.0/016:54:36ipsec ipsecdebug:candidate selectors:0.0.0.0/0<=>10.x.y.z16:54:36ipsec ipsecdebug:candidate selectors:[::/0]<=>[::/0]16:54:36ipsec ipsecdebug:searchingforpolicyforselector:0.0.0.0/0<=>10.x.y.z16:54:36ipsec ipsecdebug:generating policy16:54:36ipsec ipsecdebug:matched proposal:16:54:36ipsec ipsecdebug:proposal#116:54:36ipsec ipsecdebug:enc:aes256-cbc16:54:36ipsec ipsecdebug:auth:sha25616:54:36ipsec ipsecdebug:ike auth:finish16:54:36ipsec ipsecdebug:ID_R(DER DN):CN=styx16:54:36ipsec ipsecdebug:adding payload:ID_R16:54:36ipsec ipsecdebug:adding payload:AUTH16:54:36ipsec ipsecdebug:Certificate:16:54:36ipsec ipsecdebug:serialNr:00:b0:10:82:54:3f:d3:96:36:9a:43:c3:d6:76:78:24:e716:54:36ipsec ipsecdebug:issuer:<removed>16:54:36ipsec ipsecdebug:subject:<CN=styx>16:54:36ipsec ipsecdebug:notBefore:SunDec2312:04:05201816:54:36ipsec ipsecdebug:notAfter:WedDec2012:04:05202816:54:36ipsec ipsecdebug:selfSigned:016:54:36ipsec ipsecdebug:extensions:16:54:36ipsec ipsecdebug:key usage:digital-signature,key-encipherment16:54:36ipsec ipsecdebug:extended key usage:tls-server16:54:36ipsec ipsecdebug:basic constraints:isCa:FALSE16:54:36ipsec ipsecdebug:subject key id:b6:de:da:f2:e0:72:67:2b:95:38:b6:ad:c4:c2:6b:cd:7a:21:28:5316:54:36ipsec ipsecdebug:authority key id:18:ba:6e:15:d0:4a:17:7a:16:5f:9d:86:22:53:74:34:ea:f1:48:5816:54:36ipsec ipsecdebug:subject alternative name:16:54:36ipsec ipsecdebug:DNS:styx16:54:36ipsec ipsecdebug:signedwith:SHA256+RSA16:54:36ipsec ipsecdebug:[RSA-PUBLIC]16:54:36ipsec ipsecdebug:modulus:<removed>16:54:36ipsec ipsecdebug:publicExponent:1000116:54:36ipsec ipsecdebug:adding payload:CERT16:54:36ipsec ipsecdebug:preparinginternalIPv4address16:54:36ipsec ipsecdebug:preparinginternalIPv4netmask16:54:36ipsec ipsecdebug:preparinginternalIPv6subnet16:54:36ipsec ipsecdebug:preparinginternalIPv4DNS16:54:36ipsec ipsecdebug:adding payload:CONFIG16:54:36ipsec ipsecdebug:initiator selector:10.x.y.z16:54:36ipsec ipsecdebug:adding payload:TS_I16:54:36ipsec ipsecdebug:responder selector:0.0.0.0/016:54:36ipsec ipsecdebug:adding payload:TS_R16:54:36ipsec ipsecdebug:adding payload:SA16:54:36ipsec ipsecdebug:<-ike2 reply,exchange:AUTH:1laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874616:54:36ipsec ipsecdebug:fragmentinginto2chunks16:54:36ipsec ipsecdebug:adding payload:SKF16:54:36ipsec ipsecdebug:adding payload:SKF16:54:36ipsec ipsecdebug:IPsec-SA established:laptop_ipv6_address[4500]->mikrotik_ipv6_address[4500]spi=0x39c0e316:54:36ipsec ipsecdebug:IPsec-SA established:mikrotik_ipv6_address[4500]->laptop_ipv6_address[4500]spi=0x111be35===========================16:56:36ipsec ipsecdebug:sending dpd packet16:56:36ipsec ipsecdebug:<-ike2 request,exchange:INFORMATIONAL:0laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874616:56:36ipsec ipsecdebug:->ike2 reply,exchange:INFORMATIONAL:0laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874616:56:36ipsec ipsecdebug:payload seen:ENC16:56:36ipsec ipsecdebug:processing payload:ENC16:56:36ipsec ipsecdebug:respond:info16:56:36ipsec ipsecdebug:reply ignored===========================16:58:36ipsec ipsecdebug:sending dpd packet16:58:36ipsec ipsecdebug:<-ike2 request,exchange:INFORMATIONAL:1laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874616:58:36ipsec ipsecdebug:->ike2 reply,exchange:INFORMATIONAL:1laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874616:58:36ipsec ipsecdebug:payload seen:ENC16:58:36ipsec ipsecdebug:processing payload:ENC16:58:36ipsec ipsecdebug:respond:info16:58:36ipsec ipsecdebug:reply ignored===========================17:00:36ipsec ipsecdebug:sending dpd packet17:00:36ipsec ipsecdebug:<-ike2 request,exchange:INFORMATIONAL:2laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874617:00:36ipsec ipsecdebug:->ike2 reply,exchange:INFORMATIONAL:2laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874617:00:36ipsec ipsecdebug:payload seen:ENC17:00:36ipsec ipsecdebug:processing payload:ENC17:00:36ipsec ipsecdebug:respond:info17:00:36ipsec ipsecdebug:reply ignored===========================17:02:36ipsec ipsecdebug:sending dpd packet17:02:36ipsec ipsecdebug:<-ike2 request,exchange:INFORMATIONAL:3laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874617:02:36ipsec ipsecdebug:->ike2 reply,exchange:INFORMATIONAL:3laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874617:02:36ipsec ipsecdebug:payload seen:ENC17:02:36ipsec ipsecdebug:processing payload:ENC17:02:36ipsec ipsecdebug:respond:info17:02:36ipsec ipsecdebug:reply ignored17:02:36ipsec ipsecdebug:->ike2 request,exchange:CREATE_CHILD_SA:2laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874617:02:36ipsec ipsecdebug:payload seen:ENC17:02:36ipsec ipsecdebug:processing payload:ENC17:02:36ipsec ipsecdebug:payload seen:SA17:02:36ipsec ipsecdebug:payload seen:NONCE17:02:36ipsec ipsecdebug:payload seen:KE17:02:36ipsec ipsecdebug:create child:respond17:02:36ipsec ipsecdebug:processing payloads:NOTIFY(none found)17:02:36ipsec ipsecdebug:IKE SA rekey17:02:36ipsec ipsecdebug:processing payload:SA17:02:36ipsec ipsecdebug:IKEProtocol:IKE17:02:36ipsec ipsecdebug:proposal#117:02:36ipsec ipsecdebug:enc:aes256-cbc17:02:36ipsec ipsecdebug:prf:hmac-sha25617:02:36ipsec ipsecdebug:auth:sha25617:02:36ipsec ipsecdebug:dh:modp204817:02:36ipsec ipsecdebug:matched proposal:17:02:36ipsec ipsecdebug:proposal#117:02:36ipsec ipsecdebug:enc:aes256-cbc17:02:36ipsec ipsecdebug:prf:hmac-sha25617:02:36ipsec ipsecdebug:auth:sha25617:02:36ipsec ipsecdebug:dh:modp204817:02:36ipsec ipsecdebug:processing payload:KE17:02:36ipsec ipsecdebug:processing payload:NONCE17:02:36ipsec ipsecdebug:adding payload:SA17:02:36ipsec ipsecdebug:adding payload:KE17:02:36ipsec ipsecdebug:adding payload:NONCE17:02:36ipsec ipsecdebug:<-ike2 reply,exchange:CREATE_CHILD_SA:2laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874617:02:36ipsec ipsecdebug:->ike2 request,exchange:INFORMATIONAL:3laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874617:02:36ipsec ipsecdebug:payload seen:ENC17:02:36ipsec ipsecdebug:processing payload:ENC17:02:36ipsec ipsecdebug:payload seen:DELETE17:02:36ipsec ipsecdebug:respond:info17:02:36ipsec ipsecdebug:processing payloads:NOTIFY(none found)17:02:36ipsec ipsecdebug:<-ike2 reply,exchange:INFORMATIONAL:3laptop_ipv6_address[4500]19daf5dfb3e01030:7103e19a622b874617:02:36ipsec ipsecdebug:processing payloads:DELETE17:02:36ipsec ipsecdebug:deleteIKE SA17:02:36ipsec ipsecdebug:rekeydone17:02:37ipsec ipsecdebug:->ike2 request,exchange:CREATE_CHILD_SA:0laptop_ipv6_address[4500]b1f8195c4235d665:6f8d23efdfbda24e17:02:37ipsec ipsecdebug:payload seen:ENC17:02:37ipsec ipsecdebug:processing payload:ENC17:02:37ipsec ipsecdebug:payload seen:NOTIFY17:02:37ipsec ipsecdebug:payload seen:SA17:02:37ipsec ipsecdebug:payload seen:NONCE17:02:37ipsec ipsecdebug:payload seen:TS_I17:02:37ipsec ipsecdebug:payload seen:TS_R17:02:37ipsec ipsecdebug:create child:respond17:02:37ipsec ipsecdebug:processing payloads:NOTIFY17:02:37ipsec ipsecdebug:notify:REKEY_SA17:02:37ipsec ipsecdebug:rekeying child SA0x111be3517:02:37ipsec ipsecdebug:peer wants tunnel mode17:02:37ipsec ipsecdebug:processing payload:TS_R17:02:37ipsec ipsecdebug:0.0.0.0/017:02:37ipsec ipsecdebug:processing payload:TS_I17:02:37ipsec ipsecdebug:10.x.y.z17:02:37ipsec ipsecdebug:checking:0.0.0.0/0<=>10.x.y.z17:02:37ipsec ipsecdebug:processing payload:SA17:02:37ipsec ipsecdebug:IKEProtocol:ESP17:02:37ipsec ipsecdebug:proposal#117:02:37ipsec ipsecdebug:enc:aes256-cbc17:02:37ipsec ipsecdebug:auth:sha25617:02:37ipsec ipsecdebug:matched proposal:17:02:37ipsec ipsecdebug:proposal#117:02:37ipsec ipsecdebug:enc:aes256-cbc17:02:37ipsec ipsecdebug:auth:sha25617:02:37ipsec ipsecdebug:processing payload:NONCE17:02:37ipsec ipsecdebug:create child:finish17:02:37ipsec ipsecdebug:adding payload:NONCE17:02:37ipsec ipsecdebug:initiator selector:10.x.y.z17:02:37ipsec ipsecdebug:adding payload:TS_I17:02:37ipsec ipsecdebug:responder selector:0.0.0.0/017:02:37ipsec ipsecdebug:adding payload:TS_R17:02:37ipsec ipsecdebug:adding payload:SA17:02:37ipsec ipsecdebug:<-ike2 reply,exchange:CREATE_CHILD_SA:0laptop_ipv6_address[4500]b1f8195c4235d665:6f8d23efdfbda24e17:02:37ipsec ipsecdebug:IPsec-SA established:laptop_ipv6_address[4500]->mikrotik_ipv6_address[4500]spi=0x2bad8f117:02:37ipsec ipsecdebug:->ike2 request,exchange:INFORMATIONAL:1laptop_ipv6_address[4500]b1f8195c4235d665:6f8d23efdfbda24e17:02:37ipsec ipsecdebug:payload seen:ENC17:02:37ipsec ipsecdebug:processing payload:ENC17:02:37ipsec ipsecdebug:payload seen:DELETE17:02:37ipsec ipsecdebug:respond:info17:02:37ipsec ipsecdebug:processing payloads:NOTIFY(none found)17:02:37ipsec ipsecdebug:<-ike2 reply,exchange:INFORMATIONAL:1laptop_ipv6_address[4500]b1f8195c4235d665:6f8d23efdfbda24e17:02:37ipsec ipsecdebug:processing payloads:DELETE17:02:37ipsec ipsecdebug:deleteESP SA17:02:37ipsec ipsecdebug:deletespi:0x111be3517:02:37ipsec ipsecdebug:IPsec-SA established:mikrotik_ipv6_address[4500]->laptop_ipv6_address[4500]spi=0xed542dd17:02:37ipsec ipsecdebug:IPsec-SA killing:laptop_ipv6_address[4500]->mikrotik_ipv6_address[4500]spi=0x39c0e317:02:37ipsec ipsecdebug:IPsec-SA killing:mikrotik_ipv6_address[4500]->laptop_ipv6_address[4500]spi=0x111be3517:02:37ipsec ipsecdebug:->ike2 request,exchange:INFORMATIONAL:2laptop_ipv6_address[4500]b1f8195c4235d665:6f8d23efdfbda24e17:02:37ipsec ipsecdebug:payload seen:ENC17:02:37ipsec ipsecdebug:processing payload:ENC17:02:37ipsec ipsecdebug:payload seen:DELETE17:02:37ipsec ipsecdebug:respond:info17:02:37ipsec ipsecdebug:processing payloads:NOTIFY(none found)17:02:37ipsec ipsecdebug:<-ike2 reply,exchange:INFORMATIONAL:2laptop_ipv6_address[4500]b1f8195c4235d665:6f8d23efdfbda24e17:02:37ipsec ipsecdebug:processing payloads:DELETE17:02:37ipsec ipsecdebug:deleteIKE SA17:02:37ipsec,info killing ike2 SA:ipsec_peer1 mikrotik_ipv6_address[4500]-laptop_ipv6_address[4500]spi:6f8d23efdfbda24e:b1f8195c4235d66517:02:37ipsec,info ipsecdebug:killing ike2 SA:ipsec_peer1 mikrotik_ipv6_address[4500]-laptop_ipv6_address[4500]spi:6f8d23efdfbda24e:b1f8195c4235d66517:02:37ipsec ipsecdebug:IPsec-SA killing:laptop_ipv6_address[4500]->mikrotik_ipv6_address[4500]spi=0x2bad8f117:02:37ipsec ipsecdebug:IPsec-SA killing:mikrotik_ipv6_address[4500]->laptop_ipv6_address[4500]spi=0xed542dd17:02:37ipsec ipsecdebug:removing generated policy17:02:37ipsec,info releasing address10.x.y.z17:02:37ipsec,info ipsecdebug:releasing address10.x.y.z
```

Here the entire log for an 8 minutes long session (I added === breaks for the 2 minute dead peer detection items). I no longer see the "NO_PROPOSAL_CHOSEN" error but it disconnects regardless. I can try reducing the lifetime but I feel something else is the problem here.I also trimmed the configs, so this is the profile:And this is the proposal:And here is the full log:


---
### Author: Thu Jan 02, 2025 7:12 pm
Date: Unknown

I feel something else is the problem here.I don't say the rekey initiated by MacOS should not work, but the experience I've referred to shows it does not, so there is an issue on MacOS side.So far the only difference between your case and the one already spotted is the time until the first rekey attempt and the use of IPv6. So until it becomes clear that the same remedy (i.e. triggering the rekey before the MacOS does) does not help in your scenario, there is no point in looking for anything else - unless you can get the logs also from the MacOS side and find the explanation why it decides to disregard the Tik's response to the rekey request.


---
### Author: Thu Jan 02, 2025 8:49 pm
Date: Unknown

Well, I was wrong. I have reduced the lifetime to 1 minutes for the sake of testing and it was working for 10 minutes; reducing lifetime to 5 minutes keeps the connection working beyond 12 minutes. I guess it was both disabling PFS group and reducing the lifetime to make it work.


---
### Author: Thu Jan 02, 2025 8:56 pm
Date: Unknown

BTW what is thedh-groupused in Phase 1 proposal (in Mikrotik structure,/ip ipsec profile)?


---
### Author: Thu Jan 02, 2025 9:05 pm
Date: Unknown

It's modp2048 (I think that corresponds to DH group #14) but I included both profile and proposal in the post I included the entire log.


---
### Author: Fri Jan 03, 2025 10:54 am
Date: Unknown

I was just checking - if I get it right thepfsalgorithm in Phase 2 proposal must either be the same like the one used for D-H exchange in Phase 1 proposal ornone(which kind of raises a question why it is not just a boolean value). But this apparently was the case in your settings initially and it did not help; what makes it more interesting is that my setup above does work despite the fact that a pfs algorithm is specified.Or maybe I'll get a support call from the user as soon as he upgrades his Macbook.


---
### Author: Fri Jan 03, 2025 6:40 pm
Date: Unknown

Try tocollect logs on macOS, it will tell you what its IKEv2 initiator does not like.Also see thenote about re-authentication issues.


---
### Author: Fri Jan 03, 2025 8:19 pm
Date: Unknown

Thanks, I was able to fix this by removing the PFS group and setting the lifetime of phase2 to 5 minutes from 30 (even though I have no idea what exactly triggered the reauthentication at 8 minutes). Do you know how reauthentication can be turned off on Mikrotik?


---
### Author: Fri Jan 03, 2025 8:35 pm
Date: Unknown

Reauthentication and rekeying is not the same thing. The term reauthentication is related to Phase 1 (the "control connection") that transports relatively small data volumes, the term rekeying is related to Phase 2 that transports the actual encrypted payload. Since breaking a ciphering key becomes easier as you collect more encrypted data, it is a standard approach that Phase 2 SAs get rekeyed every N seconds and/or every M bytes transported. And there is no way to disable rekeying completely.Reauthentication has basically the same purpose because it also replaces keys used to encrypt Phase 1 traffic, but it happens much less frequently as much less data are transported over the same period of time as compared to Phase 2.


---
### Author: Sat Jan 04, 2025 6:02 am
Date: Unknown

I vaguely remember this problem when I tried to get IKEv2 responder on RouterOS to work with all of my devices.I think to troubleshoot this definitively you need all three of the following:1. Logs from RouterOS2. Logs from macOS3. A capture Phase 1 and Phase 2 packets, decrypted

