---
title: Untitled Thread
source_url: https://forum.mikrotik.com/viewtopic.php?f=9&t=207838&p=1078173#p1078173
crawled_date: 2025-02-02T21:36:38.394641
section: mikrotik_forum
type: forum_thread
---

### Author: Fri May 31, 2024 1:03 pm
Date: Unknown

After think about it, the steps in the script are:export configreplace the primary ip with the ip for the secondary device (in the export file)copy the edited export file to the secondary devicerun on the secondary device: /system/reset-configuration run-after-reset=copiedconfigHow can i edit the IP of the Export File via Script?Or add a Line to the exported config?Best Regards,iYAN


---
### Author: [SOLVED]Fri May 31, 2024 4:17 pm
Date: Unknown

```
### Infos# be sure that the firewall didn't block ftp/ssh to the device! (Add Port to OOB Interface Group)# run the script with the scheduler# Connect SFP+12 on both Devices# Admin User on Primary = primary# Admin User on Standby = standby# Set strong Passwords# Devices should have a similar or the same RouterOS Version# Tested on RouterOS 7.14.3## Initial Setup on the Primary Device# Create SSH Keys on the Primary Device## /ip ssh export-host-key key-file-prefix=primary## /user/ssh-keys/private/import user=primary private-key-file=primary_rsa.pem#### Add Scheduler on primary (Sync every day on 03 am )## /system scheduler add interval=1d name=update-standby-device on-event="/system/script/run update-standby-device" policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive,romon start-date=2024-01-01 start-time=03:00:00## Save this Script as update-standby-device## Setup the initial User on the Standby Device## /user/add group=full name=standby password=secure# Setup the Standby Interface IP## /ip/address/add address=192.168.127.2/24 interface=sfp-sfpplus12## Script:# copy Public RSA Key to Standby Device/tool/fetch address=192.168.127.2src-path=primary_rsa.pem.pub user=standby mode=ftp password=secure dst-path=primary_rsa.pem.pub upload=yes# create Config to Import SSH Key for user standby, to run ssh-exec later in this script/fileprintfile="rsa2standby.rsc"# first remove all old public keys for the user standby/fileset"rsa2standby.rsc"contents="/user/ssh-keys/remove numbers=[find where username = standby ]\n/user/ssh-keys/import public-key-file=primary_rsa.pem.pub user=standby\n"# copy an run automatic import with .auto.rsc/tool/fetch address=192.168.127.2src-path=rsa2standby.rsc.txt user=standby mode=ftp password=secure dst-path=rsa2standby.auto.rsc upload=yes/log info"Standby public RSA Key imported";# create the export from the primary device:localconfigFileName"standby.rsc"/exportfile=$configFileName show-sensitive terse:delay2# modify the config, to have still access to the standby device after import primary config#:localconfigContent[/fileget$configFileName contents]:localadd1"\n/ip/address/set [find where interface =sfp-sfpplus12 ] address=192.168.127.2/24":localadd2"\n/system/identity/set name=router-standby":localadd3"\n/user/add group=full name=standby password=secure":localadd4"\n/user set [ find name=admin ] disabled=yes":localaddlast"\n"# build the config/fileset$configFileName contents=($configContent.$add1.$add2.$add3.$add4.$addlast)# upload the config to the standby device with ftp/tool/fetch address=192.168.127.2src-path=standby.rsc user=standby mode=ftp password=secure dst-path=standby.rsc upload=yes:delay2# run via ssh-exec on the remote device the reset and import/system ssh-execaddress=192.168.127.2user=standby command="system/reset-configuration run-after-reset=standby.rsc":delay2/log info"Standby Config updated, Standby Device rebooting";
```

Hi,i want to share my ready to use script. It's a bit quick and dirty, but tested successfullyCode:Select all

