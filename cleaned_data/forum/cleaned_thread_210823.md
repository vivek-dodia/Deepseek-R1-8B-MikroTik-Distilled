# Thread Information
Title: Untitled Thread
Section: mikrotik_forum
Thread ID: 210823

# Discussion

## Initial Question
Author: Tue Sep 10, 2024 7:20 pm
My setup for ROS 6.49.17 (on an hAP lite) has only a few additions from the default configuration, just to add a PPTP Client and includes the following:/ip firewall mangleadd action=mark-routing chain=prerouting new-routing-mark=vpn passthrough=yes \src-address=192.168.92.2-192.168.92.254/ip routeadd distance=1 gateway=pptp-out1 routing-mark=vpnLikewise, my setup for ROS 7.15.3 (on a hAP ax3) also only includes the following additions (I discovered that I had to create the "routing-mark" first in the "routing table"):/routing tableadd comment="For PPTP" disabled=no fib name=vpn/ip firewall mangleadd action=mark-routing chain=prerouting new-routing-mark=vpn passthrough=yes \src-address=192.168.90.2-192.168.90.254/ip routeadd disabled=no distance=1 dst-address=0.0.0.0/0 gateway=pptp-out1 \routing-table=vpn scope=30 suppress-hw-offload=no target-scope=10My PPTP tunnel is created successfully, and I can use Tools > Ping to ping sites using their IP addresses, however, when I attempt to ping using a "name" e.g.www.google.com(which works under ROS6), under ROS7 I get "Error in Ping To - ip address expected!"It appears that the router (192.168.90.1) although still pingable is being treated differently in ROS7, and hence DNS lookups are not working.I read in thread (viewtopic.php?t=189135) that something changed in handling of packets with routing marks, however I am still quite a novice with RouterOS and would appreciate a tip on what I need to change/add to regain ROS6 style handling of the router itself (i.e. 192.168.90.1 in my case).Thanks in advance ---

## Response 1
Author: Tue Oct 22, 2024 12:08 pm
``` # 2024-10-22 15:55:45 by RouterOS 7.16.1# software id = ### model = RB941-2nD# serial number = #/interfacebridgeaddadmin-mac=#auto-mac=nocomment=defconf \ ingress-filtering=noname=bridge port-cost-mode=shortvlan-filtering=yes/interfacewirelessset[finddefault-name=wlan1]band=2ghz-b/g/n channel-width=20/40mhz-XX \ country=indonesia distance=indoors frequency=autoinstallation=indoor \ mode=ap-bridge ssid=Scalewireless-protocol=802.11/interfacewireguardaddcomment="Cloudflare WireGuard"listen-port=13231mtu=1420name=wireguard1/interfacevlanaddcomment=guestconfinterface=bridge name=vlan22 vlan-id=22/interfacebondingaddname=bonding1 slaves=ether3, ether4/interfacelistaddcomment=defconf name=WANaddcomment=defconf name=LAN/interfacewireless security-profilesset[finddefault=yes]authentication-types=wpa-psk, wpa2-psk eap-methods=""\ mode=dynamic-keys supplicant-identity=MikroTikaddeap-methods=""name=guest supplicant-identity=""/interfacewirelessaddkeepalive-frames=disabled mac-address=#master-interface=\ wlan1 multicast-buffering=disabled name=wlan2 security-profile=guest \ ssid="Scale Guest"wds-cost-range=0wds-default-cost=0wps-mode=disabled/ip kid-controladdfri=0s-1dmon=0s-1dname=system-dummy sat=0s-1dsun=0s-1dthu=0s-1dtue=\0s-1dtur-fri=0s-1dtur-mon=0s-1dtur-sat=0s-1dtur-sun=0s-1dtur-thu=\0s-1dtur-tue=0s-1dtur-wed=0s-1dwed=0s-1d/ip pooladdname=default-dhcp ranges=192.168.88.10-192.168.88.254addname=guest-dhcp ranges=192.168.84.2-192.168.84.8/ip dhcp-serveraddaddress-pool=default-dhcpinterface=bridge lease-time=10mname=defconfaddaddress-pool=guest-dhcpinterface=vlan22 lease-time=10mname=guestconf/queue simpleaddmax-limit=1M/1Mname=queue-guest target=vlan22/routing ospf instanceadddisabled=noname=default-v2/routing ospf areaadddisabled=yes instance=default-v2 name=backbone-v2/routing tableaddcomment="Cloudflare WireGuard"disabled=noname=to-Cloudflare/interfacebridge portaddbridge=bridge comment=defconf disabled=yes ingress-filtering=no\interface=ether2internal-path-cost=10path-cost=10addbridge=bridge comment=defconf disabled=yes ingress-filtering=no\interface=ether3internal-path-cost=10path-cost=10addbridge=bridge comment=defconf disabled=yes ingress-filtering=no\interface=ether4internal-path-cost=10path-cost=10addbridge=bridge comment=defconf ingress-filtering=nointerface=pwr-line1 \internal-path-cost=10path-cost=10addbridge=bridge comment=defconf ingress-filtering=nointerface=wlan1 \internal-path-cost=10path-cost=10addbridge=bridge ingress-filtering=nointerface=bonding1internal-path-cost=\10path-cost=10addbridge=bridge ingress-filtering=nointerface=wlan2internal-path-cost=10\ path-cost=10pvid=22/ip firewall connection trackingsetudp-timeout=10s/ip neighbor discovery-settingssetdiscover-interface-list=LAN/ip settingssetmax-neighbor-entries=8192/ipv6 settingssetdisable-ipv6=yes max-neighbor-entries=8192/interfacebridge vlanaddbridge=bridge tagged=bridge, bonding1 vlan-ids=22/interfacelist memberaddcomment=defconfinterface=bridge list=LANaddcomment=defconfinterface=ether1 list=WANaddinterface=ether2 list=WAN/interfaceovpn-server serversetauth=sha1, md5/interfacewireguard peersaddallowed-address=0.0.0.0/0,::/0comment="Cloudflare WireGuard"\ endpoint-address=engage.cloudflareclient.com endpoint-port=2408\interface=wireguard1 name="cloudflare wireguard"public-key=\"#"/ip addressaddaddress=192.168.88.1/24comment=defconfinterface=bridge network=\192.168.88.0addaddress=192.168.84.1/28comment=guestconf disabled=yesinterface=vlan22 \ network=192.168.84.0addaddress=192.168.100.100/24comment=wan1interface=ether1 network=\192.168.100.0addaddress=192.168.2.100/24comment=wan2interface=ether2 network=\192.168.2.0addaddress=172.16.0.2comment="Cloudflare WireGuard"interface=wireguard1 \ network=172.16.0.2/ip dhcp-clientaddcomment=defconf disabled=yesinterface=ether1addcomment=defconf disabled=yesinterface=ether2/ip dhcp-server leaseaddaddress=192.168.88.2client-id=#mac-address=\# server=defconfaddaddress=192.168.88.6mac-address=#server=defconfaddaddress=192.168.88.3client-id=#mac-address=\# server=defconfaddaddress=192.168.88.4client-id=#mac-address=\# server=defconfaddaddress=192.168.88.5mac-address=#server=defconf/ip dhcp-server networkaddaddress=192.168.84.0/28comment=guestconf dns-server=8.8.8.8, 1.1.1.1\ gateway=192.168.84.1addaddress=192.168.88.0/24comment=defconf dns-server=8.8.8.8, 1.1.1.1\ gateway=192.168.88.1/ip dnssetallow-remote-requests=yes servers=1.1.1.1, 1.0.0.1/ip dnsstaticaddaddress=192.168.88.1comment=defconf name=router.lan type=Aaddaddress=192.168.100.1name=wan1.logi.lo type=Aaddaddress=192.168.2.1name=wan2.logi.lo type=Aaddaddress=192.168.88.6name=stb1.logi.lo type=Aaddaddress=127.0.0.1name=stb2.logi.lo type=Aaddaddress=192.168.88.4name=eap1.logi.lo type=Aaddaddress=192.168.100.254name=cpe1.logi.lo type=Aaddaddress=192.168.88.2name=switch1.logi.lo type=Aaddaddress=192.168.88.3name=switch2.logi.lo type=Aaddaddress=192.168.88.5name=tlmr1.logi.lo type=A/ip firewall filteraddaction=accept chain=input comment=\"defconf: accept established, related, untracked"connection-state=\ established, related, untrackedaddaction=drop chain=input comment="defconf: drop invalid"connection-state=\ invalidaddaction=accept chain=input comment="defconf: accept ICMP"protocol=icmpaddaction=accept chain=input comment=\"defconf: accept to local loopback (for CAPsMAN)"dst-address=127.0.0.1addaction=drop chain=input comment="defconf: drop all not coming from LAN"\in-interface-list=!LANaddaction=accept chain=forward comment="defconf: accept in ipsec policy"\ ipsec-policy=in, ipsecaddaction=accept chain=forward comment="defconf: accept out ipsec policy"\ ipsec-policy=out, ipsecaddaction=fasttrack-connection chain=forward comment="defconf: fasttrack"\ connection-state=established, related hw-offload=yesaddaction=accept chain=forward comment=\"defconf: accept established, related, untracked"connection-state=\ established, related, untrackedaddaction=drop chain=forward comment="defconf: drop invalid"\ connection-state=invalidaddaction=drop chain=forward comment=\"defconf: drop all from WAN not DSTNATed"connection-nat-state=!dstnat \ connection-state=newin-interface-list=WANaddaction=drop chain=forward comment="guestconf: drop to ether2"\in-interface=vlan22out-interface=ether2/ip firewall nataddaction=masquerade chain=srcnat comment="defconf: masquerade"\ ipsec-policy=out, noneout-interface-list=WANaddaction=masquerade chain=srcnat comment="Cloudflare WireGuard"\out-interface=wireguard1/ip ipsec profileset[finddefault=yes]dpd-interval=2mdpd-maximum-failures=5/ip kid-control deviceaddmac-address=#name="Redmi-10C;2"user=""addmac-address=#name="ESP-67B077;6"user=""/ip routeaddcheck-gateway=ping comment=Recursivedisabled=nodst-address=0.0.0.0/0\ gateway=8.8.8.8target-scope=30addcheck-gateway=ping comment=Maindisabled=nodst-address=8.8.8.8/32\ gateway=192.168.100.1addcheck-gateway=ping comment=Backupdisabled=nodistance=2dst-address=\0.0.0.0/0gateway=192.168.2.1/routing bfd configurationadddisabled=nointerfaces=all min-rx=200msmin-tx=200msmultiplier=5/system clocksettime-zone-name=Asia/Jakarta/system notesetshow-at-login=no/system scheduleraddinterval=2dname=reboot on-event="/system reboot"policy=\ ftp, reboot, read, write, policy, test, password, sniff, sensitive, romon \ start-date=2021-02-28start-time=16:32:56addinterval=2hname="dns clear"on-event="/ip dns cache flush"policy=\ ftp, reboot, read, write, policy, test, password, sniff, sensitive, romon \ start-date=2021-02-28start-time=16:35:12addcomment="trigger duckdns updater"interval=1mname="duckdns updater"\ on-event="/system script run duckdns"policy=read, write, policy, test \ start-time=startup/system scriptaddcomment="duckdns updater"dont-require-permissions=noname=duckdns owner=\ admin policy=read, write, policy, test source=":local resolvedIP [:resolve \"\ #.duckdns.org\"];\ \n:local currentIP [/ip cloud get public-address];\ \n:local currentIP [:pick \$currentIP 0 [:find \$currentIP \"/\"]];\ \n\ \n:if (\$resolvedIP != \$currentIP) do={\ \n :log info (\"Trying to update DuckDNS with actual IP \".\$currentIP.\ \", resolved IP is \".\$resolvedIP);\ \n :local response [/tool fetch url=(\"https://www.duckdns.org/update\?\ domains=#&token=\ \#&ip=\".\$currentIP) check-certificat\ e=yes as-value output=user];\ \n :if (\$response->\"status\" = \"finished\") do={\ \n :if (\$response->\"data\" = \"OK\") do={\ \n :log info (\"Successfully updated DuckDNS with new IP \".\$c\ urrentIP);\ \n } else={\ \n :log error (\"Failed to update DuckDNS with new IP \".\$curr\ entIP);\ \n }\ \n }\ \n}"/tool mac-serversetallowed-interface-list=LAN/tool mac-server mac-winboxsetallowed-interface-list=LAN ``` ``` # 2024-10-22 16:57:18 by RouterOS 7.16.1# software id = ### model = RB941-2nD# serial number = #/interfacebridgeaddadmin-mac=#auto-mac=nocomment=defconf \ ingress-filtering=noname=bridge port-cost-mode=shortvlan-filtering=yes/interfacewirelessset[finddefault-name=wlan1]band=2ghz-b/g/n channel-width=20/40mhz-XX \ country=indonesia distance=indoors frequency=autoinstallation=indoor \ mode=ap-bridge ssid=Scalewireless-protocol=802.11/interfacewireguardaddcomment="Cloudflare WireGuard"listen-port=13231mtu=1420name=wireguard1/interfacevlanaddcomment=guestconfinterface=bridge name=vlan22 vlan-id=22/interfacebondingaddname=bonding1 slaves=ether3, ether4/interfacelistaddcomment=defconf name=WANaddcomment=defconf name=LAN/interfacewireless security-profilesset[finddefault=yes]authentication-types=wpa-psk, wpa2-psk eap-methods=""\ mode=dynamic-keys supplicant-identity=MikroTikaddeap-methods=""name=guest supplicant-identity=""/interfacewirelessaddkeepalive-frames=disabled mac-address=#master-interface=\ wlan1 multicast-buffering=disabled name=wlan2 security-profile=guest \ ssid="Scale Guest"wds-cost-range=0wds-default-cost=0wps-mode=disabled/ip kid-controladdfri=0s-1dmon=0s-1dname=system-dummy sat=0s-1dsun=0s-1dthu=0s-1dtue=\0s-1dtur-fri=0s-1dtur-mon=0s-1dtur-sat=0s-1dtur-sun=0s-1dtur-thu=\0s-1dtur-tue=0s-1dtur-wed=0s-1dwed=0s-1d/ip pooladdname=default-dhcp ranges=192.168.88.10-192.168.88.254addname=guest-dhcp ranges=192.168.84.2-192.168.84.8/ip dhcp-serveraddaddress-pool=default-dhcpinterface=bridge lease-time=10mname=defconfaddaddress-pool=guest-dhcpinterface=vlan22 lease-time=10mname=guestconf/queue simpleaddmax-limit=1M/1Mname=queue-guest target=vlan22/routing ospf instanceadddisabled=noname=default-v2/routing ospf areaadddisabled=yes instance=default-v2 name=backbone-v2/routing tableaddcomment="Cloudflare WireGuard"disabled=nofib name=to-Cloudflare/interfacebridge portaddbridge=bridge comment=defconf disabled=yes ingress-filtering=no\interface=ether2internal-path-cost=10path-cost=10addbridge=bridge comment=defconf disabled=yes ingress-filtering=no\interface=ether3internal-path-cost=10path-cost=10addbridge=bridge comment=defconf disabled=yes ingress-filtering=no\interface=ether4internal-path-cost=10path-cost=10addbridge=bridge comment=defconf ingress-filtering=nointerface=pwr-line1 \internal-path-cost=10path-cost=10addbridge=bridge comment=defconf ingress-filtering=nointerface=wlan1 \internal-path-cost=10path-cost=10addbridge=bridge ingress-filtering=nointerface=bonding1internal-path-cost=\10path-cost=10addbridge=bridge ingress-filtering=nointerface=wlan2internal-path-cost=10\ path-cost=10pvid=22/ip firewall connection trackingsetudp-timeout=10s/ip neighbor discovery-settingssetdiscover-interface-list=LAN/ip settingssetmax-neighbor-entries=8192/ipv6 settingssetdisable-ipv6=yes max-neighbor-entries=8192/interfacebridge vlanaddbridge=bridge tagged=bridge, bonding1 vlan-ids=22/interfacelist memberaddcomment=defconfinterface=bridge list=LANaddcomment=defconfinterface=ether1 list=WANaddinterface=ether2 list=WAN/interfaceovpn-server serversetauth=sha1, md5/interfacewireguard peersaddallowed-address=0.0.0.0/0,::/0comment="Cloudflare WireGuard"\ endpoint-address=engage.cloudflareclient.com endpoint-port=2408\interface=wireguard1 name="cloudflare wireguard"public-key=\"#"/ip addressaddaddress=192.168.88.1/24comment=defconfinterface=bridge network=\192.168.88.0addaddress=192.168.84.1/28comment=guestconf disabled=yesinterface=vlan22 \ network=192.168.84.0addaddress=192.168.100.100/24comment=wan1interface=ether1 network=\192.168.100.0addaddress=192.168.2.100/24comment=wan2interface=ether2 network=\192.168.2.0addaddress=172.16.0.2comment="Cloudflare WireGuard"interface=wireguard1 \ network=172.16.0.2/ip dhcp-clientaddcomment=defconf disabled=yesinterface=ether1addcomment=defconf disabled=yesinterface=ether2/ip dhcp-server leaseaddaddress=192.168.88.2client-id=#mac-address=\# server=defconfaddaddress=192.168.88.6mac-address=#server=defconfaddaddress=192.168.88.3client-id=#mac-address=\# server=defconfaddaddress=192.168.88.4client-id=#mac-address=\# server=defconfaddaddress=192.168.88.5mac-address=#server=defconf/ip dhcp-server networkaddaddress=192.168.84.0/28comment=guestconf dns-server=8.8.8.8, 1.1.1.1\ gateway=192.168.84.1addaddress=192.168.88.0/24comment=defconf dns-server=8.8.8.8, 1.1.1.1\ gateway=192.168.88.1/ip dnssetallow-remote-requests=yes servers=1.1.1.1, 1.0.0.1/ip dnsstaticaddaddress=192.168.88.1comment=defconf name=router.lan type=Aaddaddress=192.168.100.1name=wan1.logi.lo type=Aaddaddress=192.168.2.1name=wan2.logi.lo type=Aaddaddress=192.168.88.6name=stb1.logi.lo type=Aaddaddress=127.0.0.1name=stb2.logi.lo type=Aaddaddress=192.168.88.4name=eap1.logi.lo type=Aaddaddress=192.168.100.254name=cpe1.logi.lo type=Aaddaddress=192.168.88.2name=switch1.logi.lo type=Aaddaddress=192.168.88.3name=switch2.logi.lo type=Aaddaddress=192.168.88.5name=tlmr1.logi.lo type=A/ip firewall filteraddaction=accept chain=input comment=\"defconf: accept established, related, untracked"connection-state=\ established, related, untrackedaddaction=drop chain=input comment="defconf: drop invalid"connection-state=\ invalidaddaction=accept chain=input comment="defconf: accept ICMP"protocol=icmpaddaction=accept chain=input comment=\"defconf: accept to local loopback (for CAPsMAN)"dst-address=127.0.0.1addaction=drop chain=input comment="defconf: drop all not coming from LAN"\in-interface-list=!LANaddaction=accept chain=forward comment="defconf: accept in ipsec policy"\ ipsec-policy=in, ipsecaddaction=accept chain=forward comment="defconf: accept out ipsec policy"\ ipsec-policy=out, ipsecaddaction=fasttrack-connection chain=forward comment="defconf: fasttrack"\ connection-state=established, related hw-offload=yesaddaction=accept chain=forward comment=\"defconf: accept established, related, untracked"connection-state=\ established, related, untrackedaddaction=drop chain=forward comment="defconf: drop invalid"\ connection-state=invalidaddaction=drop chain=forward comment=\"defconf: drop all from WAN not DSTNATed"connection-nat-state=!dstnat \ connection-state=newin-interface-list=WANaddaction=drop chain=forward comment="guestconf: drop to ether2"\in-interface=vlan22out-interface=ether2/ip firewall mangleaddaction=mark-routing chain=prerouting comment="Cloudflare WireGuard"\new-routing-mark=to-Cloudflarepassthrough=nosrc-address=\192.168.88.10-192.168.88.254/ip firewall nataddaction=masquerade chain=srcnat comment="defconf: masquerade"\ ipsec-policy=out, noneout-interface-list=WANaddaction=masquerade chain=srcnat comment="Cloudflare WireGuard"\out-interface=wireguard1/ip ipsec profileset[finddefault=yes]dpd-interval=2mdpd-maximum-failures=5/ip kid-control deviceaddmac-address=#name="Redmi-10C;2"user=""addmac-address=#name="ESP-67B077;6"user=""/ip routeaddcheck-gateway=ping comment=Recursivedisabled=nodst-address=0.0.0.0/0\ gateway=8.8.8.8target-scope=30addcheck-gateway=ping comment=Maindisabled=nodistance=1dst-address=\8.8.8.8/32gateway=192.168.100.1routing-table=main scope=30\ suppress-hw-offload=notarget-scope=10addcheck-gateway=ping comment=Backupdisabled=nodistance=2dst-address=\0.0.0.0/0gateway=192.168.2.1addcomment="Cloudflare WireGuard"disabled=yes distance=1dst-address=\8.8.8.8/32gateway=wireguard1 routing-table=to-Cloudflarescope=30\ suppress-hw-offload=notarget-scope=10/routing bfd configurationadddisabled=nointerfaces=all min-rx=200msmin-tx=200msmultiplier=5/system clocksettime-zone-name=Asia/Jakarta/system notesetshow-at-login=no/system scheduleraddinterval=2dname=reboot on-event="/system reboot"policy=\ ftp, reboot, read, write, policy, test, password, sniff, sensitive, romon \ start-date=2021-02-28start-time=16:32:56addinterval=2hname="dns clear"on-event="/ip dns cache flush"policy=\ ftp, reboot, read, write, policy, test, password, sniff, sensitive, romon \ start-date=2021-02-28start-time=16:35:12addcomment="trigger duckdns updater"interval=1mname="duckdns updater"\ on-event="/system script run duckdns"policy=read, write, policy, test \ start-time=startup/system scriptaddcomment="duckdns updater"dont-require-permissions=noname=duckdns owner=\ admin policy=read, write, policy, test source=":local resolvedIP [:resolve \"\ #.duckdns.org\"];\ \n:local currentIP [/ip cloud get public-address];\ \n:local currentIP [:pick \$currentIP 0 [:find \$currentIP \"/\"]];\ \n\ \n:if (\$resolvedIP != \$currentIP) do={\ \n :log info (\"Trying to update DuckDNS with actual IP \".\$currentIP.\ \", resolved IP is \".\$resolvedIP);\ \n :local response [/tool fetch url=(\"https://www.duckdns.org/update\?\ domains=#&token=\ \#&ip=\".\$currentIP) check-certificat\ e=yes as-value output=user];\ \n :if (\$response->\"status\" = \"finished\") do={\ \n :if (\$response->\"data\" = \"OK\") do={\ \n :log info (\"Successfully updated DuckDNS with new IP \".\$c\ urrentIP);\ \n } else={\ \n :log error (\"Failed to update DuckDNS with new IP \".\$curr\ entIP);\ \n }\ \n }\ \n}"/tool mac-serversetallowed-interface-list=LAN/tool mac-server mac-winboxsetallowed-interface-list=LAN ``` Post your config for assessment, I have already discovered something missing on h is config/export file=anynameyouwish ( minus router serial number, mac address, any publicWANIP information, keys etc. )On ros7 my routerboard has more ram space, I think, but CPU usage are more heavy rather than ros6.here is my exported configuration.
```
I already rebooted the router, and then the routing tables came up.But there is more problem, I'm using recursive failover, wan 1 to my main internet, and wan 2 to my second internet as backup.When I follow the last tutorial it- add mangle "chain prerouting, src. address range of default-dhcp, action mark-routing, new routing mark to-Cloudflare"- add routes that "Dst. Address 0.0.0.0/0 to gateway wireguard1, and routing table to-Cloudflare",It works, and my internet connection follows the wireguard VPN, but after apply route my winbox disconnected from my routerboard and can't connect via IP, only via mac address, any suggestion ?here is my new configuration that I already follow that tutorial
```

```
---
```

## Response 2
Author: Tue Oct 22, 2024 2:06 pm
Way before wireguard you have to fix the errors in your config.......Firstly, you state ether2 is a WAN port and yet you have ether2 on the bridge........ It should be removed.It also states that you ahve ether3, and ether4 on the bridge but earlier you have them bonded and you also have the bond on the bridge.Im no expert but one does not put all of them on the bridge and I would hazard a guess just the bond.Now you have the bonding on the bridge and bridge doing dhcp hands out iP addresses for .88 subnet.Why do you have the bond associated with vlan22 on the single interface bridge vlan rule??/interface bridge vlanadd bridge=bridge tagged=bridge, bonding1vlan-ids=22It should be...../interface bridge vlanadd bridge=bridge tagged=bridgeuntagged=wlan2vlan-ids=22Fix interface list members./interface list memberadd comment=defconf interface=bridge list=LANadd interface=vlan22 list=LANadd comment=defconf interface=ether1 list=WANadd interface=ether2 list=WANWhy is vlan22 disabled??For wireguard allowed IPs modify this:/interface wireguard peersadd allowed-address=0.0.0.0/0,::/0comment="Cloudflare WireGuard" \endpoint-address=engage.cloudflareclient.com endpoint-port=2408 \interface=wireguard1 name="cloudflare wireguard" public-key=\"#"TO/interface wireguard peersadd allowed-address=0.0.0.0/0comment="Cloudflare WireGuard" \endpoint-address=engage.cloudflareclient.com endpoint-port=2408 \interface=wireguard1 name="cloudflare wireguard" public-key=\"#"persistent-keep-alive=35sFix IP address for wireguard....... to:add address=172.16.0.2 comment="Cloudflare WireGuard" interface=wireguard1 \network=172.16.0.0Remove current mangle rule.......Add routing rule instead.add min-prefix=0 action=lookup-only-in-table table=mainadd src-address=192.168.88.0/24 lookup-only-in-table table=to-CloudflareNEED to adjust Routes accordingly./ip routeadd check-gateway=ping dst-address=0.0.0.0/0 gateway=8.8.8.8scope=10 target-scope=12add check-gateway=ping dst-address=8.8.8.8/32 gateway=192.168.100.1scope=10 target-scope=11add distance=2 dst-address=0.0.0.0/0 gateway=192.168.2.1add dst-address=0.0.0.0/0 gateway=wireguard1 routing-table=to-CloudflareRecommend adding this mangle rule to ensure help with potential MTU issues./ip mangleadd action=change-mss chain=forward new-mss=1380 out-interface=wireguard1 protocol=tcp tcp-flags=syn tcp-mss=1381-65535++++++++++++++++++++++++++++What is going on IP addresses between 192.168.88.2-192.168.88.9 >>>>???/ip dns staticadd address=192.168.88.1 comment=defconf name=router.lan type=Aadd address=192.168.88.2 name=switch1.logi.lo type=Aadd address=192.168.88.3 name=switch2.logi.lo type=Aadd address=192.168.88.5 name=tlmr1.logi.lo type=Aetc............++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ ---

## Response 3
Author: Wed Oct 23, 2024 7:49 pm
Way before wireguard you have to fix the errors in your config.......Firstly, you state ether2 is a WAN port and yet you have ether2 on the bridge........ It should be removed.Its not on already disabledIt also states that you ahve ether3, and ether4 on the bridge but earlier you have them bonded and you also have the bond on the bridge.Im no expert but one does not put all of them on the bridge and I would hazard a guess just the bond.Now you have the bonding on the bridge and bridge doing dhcp hands out iP addresses for .88 subnet.Why do you have the bond associated with vlan22 on the single interface bridge vlan rule??/interface bridge vlanadd bridge=bridge tagged=bridge, bonding1vlan-ids=22It should be...../interface bridge vlanadd bridge=bridge tagged=bridgeuntagged=wlan2vlan-ids=22Fix interface list members./interface list memberadd comment=defconf interface=bridge list=LANadd interface=vlan22 list=LANadd comment=defconf interface=ether1 list=WANadd interface=ether2 list=WANIm trying to follow you, remove bonding1 from tagged vlan bridge, and add vlan22 on lan interface list, but it doesn't work. My access point using vlan to divide wireless. The diagram its on image attachments. Or do I made mistakes here ?Why is vlan22 disabled??Its on already enabled.++++++++++++++++++++++++++++What is going on IP addresses between 192.168.88.2-192.168.88.9 >>>>???/ip dns staticadd address=192.168.88.1 comment=defconf name=router.lan type=Aadd address=192.168.88.2 name=switch1.logi.lo type=Aadd address=192.168.88.3 name=switch2.logi.lo type=Aadd address=192.168.88.5 name=tlmr1.logi.lo type=Aetc............++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++I make that IP reserved for that devices.For wireguard allowed IPs modify this:/interface wireguard peersadd allowed-address=0.0.0.0/0,::/0comment="Cloudflare WireGuard" \endpoint-address=engage.cloudflareclient.com endpoint-port=2408 \interface=wireguard1 name="cloudflare wireguard" public-key=\"#"TO/interface wireguard peersadd allowed-address=0.0.0.0/0comment="Cloudflare WireGuard" \endpoint-address=engage.cloudflareclient.com endpoint-port=2408 \interface=wireguard1 name="cloudflare wireguard" public-key=\"#"persistent-keep-alive=35sFix IP address for wireguard....... to:add address=172.16.0.2 comment="Cloudflare WireGuard" interface=wireguard1 \network=172.16.0.0Remove current mangle rule.......Add routing rule instead.add min-prefix=0 action=lookup-only-in-table table=mainadd src-address=192.168.88.0/24 lookup-only-in-table table=to-CloudflareAfter I add routing rules, winbox can't connect to router using IP address, why ?==== ====I think my question is out of this topic, so I made the new topic for my questions...viewtopic.php?t=212011&sid=d60011cf12d2 ... a9c2ab3ac0