---
title: Untitled Thread
source_url: https://forum.mikrotik.com/viewtopic.php?f=2&t=213724&p=1121556&amp;sid=3b77a3334c914448dbbc02bfdff4c3aa#p1121556
crawled_date: 2025-02-02T21:56:18.074426
section: mikrotik_forum
type: forum_thread
keywords: rest
---

### Author: Thu Jan 23, 2025 3:11 pm
Date: Unknown

```
/queue type
add cake-diffserv=diffserv4 cake-flowmode=dual-srchost cake-nat=yes kind=cake name=cake-WAN-tx
add cake-diffserv=besteffort cake-flowmode=dual-dsthost cake-nat=yes kind=cake name=cake-WAN-rx
/queue simple
add comment="RX= Target Upload TX = Target Download" max-limit=950M/95M name=cake-WAN queue=cake-WAN-rx/cake-WAN-tx target=bridge1_WAN
```

I found the same: rx/tx values in simple queue are swapped compared to what one would expect: RX is target interface upload and TX is target interface downloadThe configuration below works well on 1000/100 cable connections with users complaining about downloads or uploads of many and/or large files interferes with parallel Teams/Zooms etc. calls.The rx besteffort queue to limit the ingress WAN traffic shortly before the ISP traffic shaper kicks in. This has shown to have less impact on latency.Th tx diffserv4 queue does a good job in prioritizing outgoing Teams/Zoom traffic if the uplink is fully loaded. At least the complaints have stopped.Code:Select all


---
### Author: Fri Jan 24, 2025 10:37 pm
Date: Unknown

I agree with you that if your nearest CDN is less than 30ms away - and you aren´t trying to communicate worldwide, that regional is a good setting.Am I not gambling that myfurthestcommonly-used CDN is less than 30ms away, and that the consequences of being wrong occasionally are minor?However, the ack-filter on rx is largely useless and eats cpu. You only need it on tx in your environment.That's insightful, thanks. I've not only removed that useless bit from the config, I added this paragraph:"We do this on the cake-tx side alone because in typical cases, we can only control what we send to remote TCP/IP stacks, not what they do in turn. There are exceptions to this, as with a site-to-site WireGuard tunnel, but even in that case ACK filtering has its most useful effect on the narrow side of an asymmetric pipe. Consequently, the best strategy is to do this ACK filtering on each peer’s Tx side alone, improving the remote site’s Rx queuing from afar."Yes, the chances of being wrong occasionally are very minor. It is better, especially, when inbound shaping, to be using your typical RTT as the estimate so as to get control of the queue before it flows into the isp shaper you are defeating.The codel algorithm was designed to scale to worldwide RTTs (280ms) with its default settings of target 5ms, interval 100. It was also designed so that a single TCP flow could use up nearly all the bandwidth, so long as the RTT was in that range. The most common use cases nowadays is 15 short flows from a web browser, 5 or more from torrent, and in general interactive flows like voip and videoconferencing use so little bandwidth that they never see a drop.With lots of flows, and/or short rtts in general codel isn´t actually responsive enough.A case where using the regional RTT might hurt (30ms interval, 1.5ms target) is where a single packet takes longer than the bandwidth to "fit". At 10Mbit, a single packet fits into 1.3ms.Since the development of codel, linux based hosts have adopted packet pacing which tends towards working better at short and long ranges. I haven´t got any real benchmarks of such however.Anyway, unless if you are in a case where you have to transmit lots of data over a single flow, somewhere further than 100ms away, and you have > 10Mbit/s bandwidth, the regional setting should be fine...."We do this on the cake-tx side alone when we have a greater than 10x1 download/upload ratio, on the narrow end of an asymmetric pipe, where the acks from a single TCP flow can saturate the upload. Ack-filtering does not do any good for encrypted traffic - as with a site-to-site WireGuard tunnel. Acks will almost never be queued on the rx side, there is no point it attempting to filter there.""

