# Thread Information
Title: Thread-1120684
Section: RouterOS
Thread ID: 1120684

# Discussion

## Initial Question
I have a docker host running many docker apps. Some apps are exposed are using the host 192.168.12.8:port. How to create hairpin so I can access the apps thru FQDN within my LAN?Here is my config:
```
# 2025-01-21 18:35:43 by RouterOS 7.14.3# software id = YDH9-P57P## model = RB5009UG+S+# serial number = XXXXXXXXX/interfacebridgeaddname=br-Uplinkport-cost-mode=shortvlan-filtering=yesaddname=containers/interfaceethernetset[finddefault-name=ether1]comment="POE swith /wi-fi"name=\
    ether1-LAN-Hybridset[finddefault-name=ether2]comment=proxmox name=ether2-LAN-Hybridset[finddefault-name=ether3]comment="ABB IPS 2.1"name=ether3-LAN-Accessset[finddefault-name=ether4]name=ether4-LANset[finddefault-name=ether7]comment=mngmnt name=ether7-LAN-mngmntset[finddefault-name=ether8]name=ether8-WAN-Staticset[finddefault-name=sfp-sfpplus1]disabled=yes/interfacevethaddaddress=172.17.0.2/24gateway=172.17.0.1gateway6=""name=veth1/interfacewireguardaddlisten-port=14567mtu=1420name=wireguard1/interfacevlanaddcomment="Management VLAN"interface=br-Uplinkname=Management-10vlan-id=\10addcomment="Traefik proxy"interface=br-Uplinkname=Proxy-11vlan-id=11addcomment="Smart Home VLAN"interface=br-Uplinkname="Smart Home-30"\
    vlan-id=30addcomment="Users VLAN"interface=br-Uplinkname=Users-100vlan-id=100addcomment="Servers VLAN"interface=br-Uplinkname=vlan12-Serversvlan-id=12/interfacelistaddname=LANaddname=WANaddname=MGMT/interfacewireless security-profilesset[finddefault=yes]supplicant-identity=MikroTik/ip kid-controladddisabled=yes name=Sofia/ip pooladdname=dhcp_management_pool ranges=192.168.10.242-192.168.10.249addname=dhcp_users_pool ranges=192.168.100.100-192.168.100.249addname=dhcp_smarthome_pool ranges=192.168.30.100-192.168.30.249addname=dhcp_servers_pool ranges=192.168.12.242-192.168.12.254/ip dhcp-serveraddaddress-pool=dhcp_management_poolinterface=Management-10name=\
    dhcp-managementaddaddress-pool=dhcp_smarthome_poolinterface="Smart Home-30"name=\"dhcp-smart home"addaddress-pool=dhcp_servers_poolinterface=vlan12-Serversname=dhcp-servers/containeraddinterface=veth1 root-dir=usb1/Adguardstart-on-boot=yes workdir=\/opt/adguardhome/work/container configsetregistry-url=https://registry-1.docker.io tmpdir=usb2/interfacebridge portaddbridge=br-Uplinkcomment="unmanaged switch poe"interface=\
    ether1-LAN-Hybridinternal-path-cost=10path-cost=10pvid=30addbridge=br-Uplinkcomment=proxmoxinterface=ether2-LAN-Hybridpvid=12addbridge=br-Uplinkcomment="ABB IPS"frame-types=\
    admit-only-untagged-and-priority-taggedinterface=ether3-LAN-Accesspvid=\30addbridge=br-Uplinkcomment="office(right socket)"frame-types=\
    admit-only-untagged-and-priority-taggedinterface=ether4-LAN pvid=10addbridge=br-Uplinkcomment=unknown frame-types=\
    admit-only-untagged-and-priority-taggedinterface=ether7-LAN-mngmnt pvid=\10addbridge=containersinterface=veth1/ip firewall connection trackingsetudp-timeout=10s/ip neighbor discovery-settingssetdiscover-interface-list=MGMT/interfacebridge vlanaddbridge=br-Uplinktagged=ether2-LAN-Hybrid,br-Uplinkuntagged=\
    ether1-LAN-Hybrid,ether3-LAN-Accessvlan-ids=30addbridge=br-Uplinkcomment="wifi users"tagged=\
    ether1-LAN-Hybrid,br-Uplink,ether2-LAN-Hybridvlan-ids=100addbridge=br-Uplinktagged=ether1-LAN-Hybrid,br-Uplink,ether2-LAN-Hybrid\
    vlan-ids=10addbridge=br-Uplinktagged=ether1-LAN-Hybrid,br-Uplinkuntagged=\
    ether2-LAN-Hybridvlan-ids=12addbridge=br-Uplinktagged=ether1-LAN-Hybrid,br-Uplinkuntagged=\
    ether2-LAN-Hybridvlan-ids=11/interfacelist memberaddinterface=ether8-WAN-Staticlist=WANaddinterface=Management-10list=LANadddisabled=yesinterface=br-Uplinklist=LANaddinterface=Users-100list=LANaddinterface=wireguard1 list=LANaddinterface=wireguard1 list=MGMTaddinterface=Management-10list=MGMTaddinterface="Smart Home-30"list=LANaddinterface=vlan12-Serverslist=LAN/interfacewireguard peersaddallowed-address=10.10.20.2/32comment=lubo-pcinterface=wireguard1 \public-key="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"addallowed-address=10.10.20.3/32client-dns=172.17.0.2comment=\"Lubo iphone 15 Pro"interface=wireguard1public-key=\"qY77/YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY"addallowed-address=10.10.20.4/32client-dns=172.17.0.2interface=wireguard1 \public-key="ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ"/ip addressaddaddress=XXX.XXX.XX.XX/24interface=ether8-WAN-Staticnetwork=151.237.32.0addaddress=192.168.12.1/24interface=vlan12-Serversnetwork=192.168.12.0addaddress=192.168.100.1/24interface=Users-100network=192.168.100.0addaddress=192.168.10.1/24interface=Management-10network=192.168.10.0addaddress=192.168.30.1/24interface="Smart Home-30"network=192.168.30.0addaddress=10.10.20.1/24interface=wireguard1 network=10.10.20.0addaddress=172.17.0.1/24interface=containers network=172.17.0.0/ip dhcp-serveraddaddress-pool=dhcp_users_poolinterface=Users-100name=dhcp-users \
    parent-queue=*FFFFFFFF/ip dhcp-server leaseaddaddress=192.168.10.250client-id=1:d8:d0:90:1b:5b:af comment=\"Lubo Yoga Wired"mac-address=D8:D0:90:1B:5B:AF server=dhcp-managementaddaddress=192.168.10.6client-id=1:1c:61:b4:14:a0:2ccomment=\"TP Link EAP 615 Bedroom"mac-address=1C:61:B4:14:A0:2Cserver=\
    dhcp-managementaddaddress=192.168.10.5client-id=1:1c:61:b4:14:a9:a8 comment=\"TP Link EAP 615 Living Room"mac-address=1C:61:B4:14:A9:A8 server=\
    dhcp-managementaddaddress=192.168.100.204client-id=1:48:a6:b8:7:73:e2 comment="Sonos ARC"\
    mac-address=48:A6:B8:07:73:E2 server=dhcp-usersaddaddress=192.168.100.249client-id=1:72:70:2a:fe:13:ab comment=\"iPad Living Room"mac-address=72:70:2A:FE:13:AB server=dhcp-usersaddaddress=192.168.100.203client-id=1:54:2a:1b:23:ee:38comment="Sonos SUB"\
    mac-address=54:2A:1B:23:EE:38server=dhcp-usersaddaddress=192.168.100.202client-id=1:f0:f6:c1:c5:cf:d4 comment=\"Sonos ERA 300"mac-address=F0:F6:C1:C5:CF:D4 server=dhcp-usersaddaddress=192.168.100.201client-id=1:f0:f6:c1:c5:cf:58comment=\"Sonos ERA 300"mac-address=F0:F6:C1:C5:CF:58server=dhcp-usersaddaddress=192.168.30.2client-id=1:2:78:7f:7f:66:2ecomment=\"Home Assistant"mac-address=02:78:7F:7F:66:2Eserver="dhcp-smart home"addaddress=192.168.30.205client-id=1:64:d2:c4:e1:f5:dc comment=\"Apple TV Bedroom - Wireless"mac-address=64:D2:C4:E1:F5:DC server=\"dhcp-smart home"addaddress=192.168.30.3comment="ABB IPS2.1 (KNX)"mac-address=\00:0C:DE:93:50:5Aserver="dhcp-smart home"addaddress=192.168.30.250client-id=1:b0:a4:60:9a:8c:1acomment=\"YOGA camelot"mac-address=B0:A4:60:9A:8C:1Aserver="dhcp-smart home"addaddress=192.168.100.250client-id=1:b0:a4:60:9a:8c:1acomment=\"YOGA castle"mac-address=B0:A4:60:9A:8C:1Aserver=dhcp-usersaddaddress=192.168.30.4client-id=1:0:24:6d:2:a6:6ccomment=1HOME\
    mac-address=00:24:6D:02:A6:6Cserver="dhcp-smart home"addaddress=192.168.30.5client-id=1:64:d2:c4:d4:fb:c7 comment=\"Apple TV Bedroom - Wired"mac-address=64:D2:C4:D4:FB:C7 server=\"dhcp-smart home"addaddress=192.168.12.244client-id=1:3c:2a:f4:4c:81:e8 comment=\"Brother HL-3170CDW Printer"mac-address=3C:2A:F4:4C:81:E8 server=\
    dhcp-serversaddaddress=192.168.30.251client-id=1:e2:2e:15:51:59:4ecomment=\"Lubo Ipad Pro"mac-address=E2:2E:15:51:59:4Eserver="dhcp-smart home"addaddress=192.168.100.251client-id=1:9a:62:bd:95:32:39comment=\"Lubo IPhone 15 Pro"mac-address=9A:62:BD:95:32:39server=dhcp-usersaddaddress=192.168.30.252client-id=1:36:aa:c:fc:82:7dcomment=\"Lubo IPhone 15 Pro"mac-address=36:AA:0C:FC:82:7Dserver=\"dhcp-smart home"addaddress=192.168.30.194client-id=1:68:fc:ca:ce:9d:42comment=\"\?\?\? Sofia Device"mac-address=68:FC:CA:CE:9D:42server=\"dhcp-smart home"addaddress=192.168.100.10client-id=1:c2:47:9e:35:37:4dcomment=\"Lubo iPhone"mac-address=C2:47:9E:35:37:4Dserver=dhcp-usersaddaddress=192.168.100.179client-id=1:82:46:39:9f:cb:1dcomment=\"\?\?\? Sofia Device"mac-address=82:46:39:9F:CB:1Dserver=dhcp-usersaddaddress=192.168.100.144client-id=1:4a:3a:9d:84:1f:47comment=\"\?\?\? Sofia Device"mac-address=4A:3A:9D:84:1F:47server=dhcp-usersaddaddress=192.168.100.143client-id=1:32:4:6b:61:39:85comment=\"Lubo Iphone"mac-address=32:04:6B:61:39:85server=dhcp-usersaddaddress=192.168.100.2client-id=1:bc:24:11:62:b7:2acomment=\"Home Assistant second interface"mac-address=BC:24:11:62:B7:2Aserver=\
    dhcp-usersaddaddress=192.168.100.4comment="Tedee Bridge"mac-address=\94:C9:60:DF:C1:65server=dhcp-usersaddaddress=192.168.100.142client-id=1:6c:c7:ec:91:f7:b1 comment=\"Sofia Galaxy S9"mac-address=6C:C7:EC:91:F7:B1 server=dhcp-usersaddaddress=192.168.100.173client-id=1:f4:3b:d8:11:2b:c3 comment=\"Sofia School Tablet"mac-address=F4:3B:D8:11:2B:C3 server=dhcp-usersaddaddress=192.168.100.3client-id=1:a0:dd:6c:29:6e:4comment=\"Shelly Plus Uni"mac-address=A0:DD:6C:29:6E:04server=dhcp-usersaddaddress=192.168.100.127client-id=1:8e:4b:3f:da:e2:c6 comment=\"lubo iphone"mac-address=8E:4B:3F:DA:E2:C6 server=dhcp-usersaddaddress=192.168.30.6client-id=1:ec:71:db:1b:95:5ccomment=\"reolink camera"mac-address=EC:71:DB:1B:95:5Cserver="dhcp-smart home"addaddress=192.168.12.4comment=bumblebee mac-address=7A:33:B6:2F:9E:8Faddaddress=192.168.12.5comment="docker-server(wiki-js)"mac-address=\3A:A8:87:E3:A2:9Aaddaddress=192.168.12.7comment=calibre mac-address=FA:75:1F:A8:D2:F4addaddress=192.168.12.6comment=rclone-service mac-address=BC:24:11:3A:C7:90addaddress=192.168.12.245client-id=\
    ff:ca:53:9:5a:0:2:0:0:ab:11:67:b8:45:2:18:ee:dd:bf comment="omv nas"\
    mac-address=BC:24:11:73:9C:B2 server=dhcp-serversaddaddress=192.168.12.8comment=ironhide mac-address=BC:24:11:D3:9A:04/ip dhcp-server networkaddaddress=192.168.10.0/24comment=mngmt dns-server=8.8.8.8gateway=\192.168.10.1addaddress=192.168.12.0/24comment=servers dns-server=8.8.8.8gateway=\192.168.12.1addaddress=192.168.30.0/24comment="smart home"dns-server=8.8.8.8gateway=\192.168.30.1addaddress=192.168.100.0/24comment=users dns-server=172.17.0.2,8.8.8.8\
    gateway=192.168.100.1/ip dnssetallow-remote-requests=yes servers=172.17.0.2,8.8.8.8/ip firewall address-listaddaddress=192.168.12.0/24list=Serversaddaddress=192.168.100.0/24list=Usersaddaddress=192.168.30.0/24list=SmartHomeaddaddress=192.168.12.0/24list=LANaddaddress=192.168.30.0/24list=LANaddaddress=192.168.10.0/24list=LANaddaddress=192.168.100.0/24list=LANaddaddress=XXX.XXX.XXX.XXX list=Svetulchoaddaddress=192.168.10.250comment="admin local"list=Authorizedaddaddress=192.168.30.250comment="admin wifi"disabled=yes list=Authorizedaddaddress=10.10.20.2comment="admin remote wireguard"list=Authorizedaddaddress=10.10.20.3comment="admin remote ios wireguard"list=Authorizedaddaddress=192.168.100.251comment="admin wifi"disabled=yes list=Authorizedaddaddress=10.10.20.4comment="admin remote ios wireguard"list=Authorizedaddaddress=10.10.20.0/24list=LAN/ip firewall filteraddaction=fasttrack-connection chain=forward comment="defconf: fasttrack"\
    connection-state=established,related hw-offload=yesaddaction=accept chain=forward comment=\"defconf: accept established,related, untracked"connection-state=\
    established,related,untrackedaddaction=drop chain=forward comment="defconf: drop invalid"\
    connection-state=invalidaddaction=accept chain=forward comment="allow internet traffic"\in-interface-list=LANout-interface-list=WANaddaction=accept chain=forward comment="allow access from LAN to Plex"\
    disabled=yes dst-address=192.168.12.140dst-port=32400protocol=tcp \
    src-address-list=LANaddaction=accept chain=forward comment="allow access from LAN to Frigate"\
    disabled=yes dst-address=192.168.12.141src-address-list=LANaddaction=accept chain=forward comment=\"allow access from LAN to Home Assistant"dst-address=192.168.30.2\
    dst-port=8123protocol=tcp src-address-list=LANaddaction=accept chain=forward comment=\"allow access from LAN to MQTT service @ Home Assistant"dst-address=\192.168.30.2dst-port=1883protocol=tcp src-address-list=LANaddaction=accept chain=forward comment="Allow connection to doorbell camera"\
    dst-address=192.168.30.6protocol=tcp src-address-list=LANaddaction=accept chain=forward comment="LAN to Adguard"dst-address=\172.17.0.2src-address-list=LANaddaction=accept chain=forwardin-interface-list=MGMTout-interface-list=LAN \
    src-address-list=Authorizedaddaction=accept chain=forward comment="port forwarding"\
    connection-nat-state=dstnataddaction=accept chain=forward comment=\"allow access for containers to internet"in-interface=containers \out-interface=ether8-WAN-Staticaddaction=drop chain=forward comment="Drop all else"addaction=accept chain=input comment=\"accept established, related, untracked"connection-state=\
    established,related,untrackedaddaction=drop chain=input connection-state=invalidaddaction=accept chain=input protocol=icmpaddaction=accept chain=input comment="wireguard handshake"dst-port=14567\
    protocol=udpaddaction=accept chain=input comment="Access for MGMT"in-interface-list=\
    MGMT src-address-list=Authorizedaddaction=accept chain=input comment="users to services"dst-port=53\in-interface-list=LAN protocol=udpaddaction=accept chain=input comment="users to services"dst-port=53\in-interface-list=LAN protocol=tcpaddaction=drop chain=input comment="Drop all else"/ip firewall nataddaction=masquerade chain=srcnatout-interface=ether8-WAN-Staticaddaction=dst-nat chain=dstnat comment="port 443 to nginx proxy"disabled=\
    yes dst-port=443in-interface=ether8-WAN-Staticprotocol=tcp \
    to-addresses=192.168.12.254to-ports=443addaction=dst-nat chain=dstnat comment="port 80 to docker host"dst-port=80\in-interface=ether8-WAN-Staticprotocol=tcp to-addresses=192.168.12.8\
    to-ports=81addaction=dst-nat chain=dstnat comment="port 443 to docker host"dst-port=\443in-interface=ether8-WAN-Staticprotocol=tcp to-addresses=192.168.12.8\
    to-ports=444addaction=dst-nat chain=dstnat comment="port 32400 to Plex"disabled=yes \
    dst-port=32400in-interface=ether8-WAN-Staticprotocol=tcp to-addresses=\192.168.12.140to-ports=32400/ip routeadddisabled=nodst-address=0.0.0.0/0gateway=151.237.32.1routing-table=main \
    suppress-hw-offload=no/ip servicesetwww disabled=yes/system clocksettime-zone-name=Europe/Sofia/system identitysetname=RB5009/system notesetshow-at-login=no/tool mac-server mac-winboxsetallowed-interface-list=MGMT/tool sniffersetfilter-interface=ether2-LAN-HybridThanks.

---
```

## Response 1
Add the following NAT rule before the default masquerade one:
```
/ip firewall nataddaction=masquerade chain=srcnat dst-address=192.168.12.8src-address=192.168.12.0/24

---
```

## Response 2
A wider rule, that is often prescribed is dst-address=192.168.12.0/24src=addres192.168.12.0/24( intent here is if you have more than one server active in the subnet ) ---