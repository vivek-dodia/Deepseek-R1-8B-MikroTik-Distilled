---
title: Untitled Thread
source_url: https://forum.mikrotik.com/viewtopic.php?f=2&t=209239&p=1085433&amp;sid=3b77a3334c914448dbbc02bfdff4c3aa#p1085433
crawled_date: 2025-02-02T21:31:55.555237
section: mikrotik_forum
type: forum_thread
---

### Author: Fri Jul 12, 2024 8:13 pm
Date: Unknown

```
# Title: StevenBlack/hosts
#
# This hosts file is a merged collection of hosts from reputable sources,
# with a dash of crowd sourcing via GitHub
#
# Date: 11 July 2024 19:19:26 (UTC)
# Number of unique domains: 155,096
#
# Fetch the latest version of this file: https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts
# Project home page: https://github.com/StevenBlack/hosts
# Project releases: https://github.com/StevenBlack/hosts/releases
#
# ================================================ ==============

127.0.0.1 localhost
127.0.0.1 localhost.localdomain
127.0.0.1 local
255.255.255.255 broadcasthost
::1 localhost
::1 ip6-localhost
::1 ip6-loopback
fe80::1%lo0 localhost
ff00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
0.0.0.0 0.0.0.0

# Custom host records are listed here.


# End of custom host records.
# Start StevenBlack

#=====================================
# Title: Hosts contributed by Steven Black
# http://stevenblack.com

0.0.0.0 ck.getcookiestxt.com
0.0.0.0 eu1.clevertap-prod.com
0.0.0.0 wizhumpgyros.com
0.0.0.0 coccyxwickimp.com
0.0.0.0 webmail-who-int.000webhostapp.com
...........................
```

```
0.0.0.0 XXXXXXXXXXXX
```

```
url="https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts" ssl-verify=no 
     match-count=0 name-count=0
```

Hello, are you having problem adding url list of StevenBlack ?  When I add it to Adlist it doesn't recognize any results and matches. I think it's because the sheet starts with this:Code:Select allIf I make my own file and copy only the useful information from its list things work.Code:Select allBecause in the video tutorial things work out, but I don't know then if the leaf looked like this .https://help.mikrotik.com/docs/display/ROS/DNSHere is my situation:Code:Select all


---
### Author: Sun Jul 14, 2024 12:42 pm
Date: Unknown

```
Flags: X - disabled 
 0   url="https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts" 
     ssl-verify=no match-count=2368 name-count=154749
```

```
Flags: X - disabled 
 0   url="https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts" 
     ssl-verify=no match-count=0 name-count=17266
```

You have to set your DHCP server or the hosts themselves manually, the DNS server to be the IP address of the Routerboard on which you use Adlist, then you will start to have reporting. The interesting thing is that for me it gives me 154749 on hAP AX3, and on my virtual machine I installed RouterOS with x86 architecture and there it recognizes them as 17266 entries, and for you it gives them 100908. It's different for everyone, I can't explain it.hAP AX3Code:Select allVirtual RouterOS x86Code:Select all


---
### Author: Sun Jul 14, 2024 2:52 pm
Date: Unknown

```
curl -s https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts | grep -v '#' | sed '/^$/d' | wc -l
154749
```

```
0.0.0.0 iesnare.com # See http://www.codingthewheel.com/archives/online-gambling-privacy-iesnare
0.0.0.0 www.iesnare.com # See http://www.codingthewheel.com/archives/online-gambling-privacy-iesnare
```

Lets see:Code:Select allIt's not correct because it removes the lines with hash tags even if the hash tag come after correct value.Like this lines.Code:Select allSo these lists have to be massaged a little bit before going into the mikrotik device.


---
### Author: Sun Jul 14, 2024 4:48 pm
Date: Unknown

```
curl -s https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts | sed -e 's/#.*$//' -e '/^$/d' | wc -l
155122
```

Lets see:Let me fix it for you:Code:Select all


---
### Author: Mon Jul 22, 2024 7:24 am
Date: Unknown

```
:delay 10s
# Check cache size and adjust if not large enough
:if ([ip/dns/get cache-size]!=32768) do={/ip/dns/set cache-size=32768}
# Remove all current adlists
/ip/dns/adlist remove [find]
# Fetch new adlist source file(s)
/tool/fetch url=https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts output=file dst-path=sblack-unified-adlist
# Short delay to ensure file is created in RAM
:delay 1s
# Create new adlist from file
/ip/dns/adlist/add file=sblack-unified-adlist
# Remove temp file from RAM
/file remove sblack-unified-adlist
```

```
[admin@RB760iGS] > /ip/dns/print
                   cache-size: 32768KiB
                cache-max-ttl: 1w
      address-list-extra-time: 0s
                          vrf: main
                   cache-used: 17819KiB
[admin@RB760iGS] > /ip/dns/adlist/print
Flags: X - disabled
 0   file=sblack-unified-adlist match-count=0 name-count=158886
```

The problem is poor/stupid programmer or design decision to download adlist files first to device storage instead of memory....  Since the HexS only has 16 MB of storage, and *at best* only a few MB free with ROS 7, you see the problem.I use this script I made, which downloads the target file into*memory*and not the permanent storage:Code:Select allAnd it works just fine.  That list on my HexS shows:Code:Select allHave fun.Edit:  This also gives added bonus of not needlessly wearing out your flash storage by downloading adlist over and over again to it…


---
### Author: Mon Jul 22, 2024 11:20 am
Date: Unknown

# Create new adlist from file/ip/dns/adlist/add file=sblack-unified-adlistMaybe change it to# Create new adlist from file/ip/dns/adlist/add file=sblack-unified-adlist ssl-verify=noMikrotik says no about ssl herehttps://help.mikrotik.com/docs/display/ROS/DNS


---
### Author: Fri Aug 09, 2024 1:24 pm
Date: Unknown

```
:delay 10s
# Check cache size and adjust if not large enough
:if ([ip/dns/get cache-size]!=32768) do={/ip/dns/set cache-size=32768}
# Remove all current adlists
/ip/dns/adlist remove [find]
# Fetch new adlist source file(s)
/tool/fetch url=https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts output=file dst-path=sblack-unified-adlist
# Short delay to ensure file is created in RAM
:delay 1s
# Create new adlist from file
/ip/dns/adlist/add file=sblack-unified-adlist
# Remove temp file from RAM
/file remove sblack-unified-adlist
```

```
[admin@RB760iGS] > /ip/dns/print
                   cache-size: 32768KiB
                cache-max-ttl: 1w
      address-list-extra-time: 0s
                          vrf: main
                   cache-used: 17819KiB
[admin@RB760iGS] > /ip/dns/adlist/print
Flags: X - disabled
 0   file=sblack-unified-adlist match-count=0 name-count=158886
```

The problem is poor/stupid programmer or design decision to download adlist files first to device storage instead of memory....  Since the HexS only has 16 MB of storage, and *at best* only a few MB free with ROS 7, you see the problem.I use this script I made, which downloads the target file into*memory*and not the permanent storage:Code:Select allAnd it works just fine.  That list on my HexS shows:Code:Select allHave fun.Edit:  This also gives added bonus of not needlessly wearing out your flash storage by downloading adlist over and over again to it…My compliments! On my AC2 it works perfectly, just one thing_ to update the file automatically I imagine I have to create a scheduler in ROS to run the script every certain amount of time (2 times a day?)?


---
### Author: Wed Sep 04, 2024 2:16 pm
Date: Unknown

```
:delay 10s
# Check cache size and adjust if not large enough
:if ([ip/dns/get cache-size]!=32768) do={/ip/dns/set cache-size=32768}
# Remove all current adlists
/ip/dns/adlist remove [find]
# Fetch new adlist source file(s)
/tool/fetch url=https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts output=file dst-path=sblack-unified-adlist
# Short delay to ensure file is created in RAM
:delay 1s
# Create new adlist from file
/ip/dns/adlist/add file=sblack-unified-adlist ssl-verify=no
# Remove temp file from RAM
/file remove sblack-unified-adlist
```

```
[admin@RB760iGS] > /ip/dns/print
                   cache-size: 32768KiB
                cache-max-ttl: 1w
      address-list-extra-time: 0s
                          vrf: main
                   cache-used: 17819KiB
[admin@RB760iGS] > /ip/dns/adlist/print
Flags: X - disabled
 0   file=sblack-unified-adlist match-count=0 name-count=158886
```

The problem is poor/stupid programmer or design decision to download adlist files first to device storage instead of memory....  Since the HexS only has 16 MB of storage, and *at best* only a few MB free with ROS 7, you see the problem.I use this script I made, which downloads the target file into*memory*and not the permanent storage:Code:Select allAnd it works just fine.  That list on my HexS shows:Code:Select allHave fun.Edit:  This also gives added bonus of not needlessly wearing out your flash storage by downloading adlist over and over again to it…THANKS,it worked on low-end devices


---
### Author: Tue Oct 01, 2024 4:43 pm
Date: Unknown

```
:if ([ip/dns/get cache-size]!=32768) do={/ip/dns/set cache-size=32768}
```

```
/ip/dns/adlist remove [find]
```

```
/tool/fetch url="https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts" output=file dst-path=sblack-unified-adlist
```

```
/ip/dns/adlist/add file=sblack-unified-adlist
```

```
/file remove sblack-unified-adlist
```

```
/ip/dns/print
```

```
/ip/dns/adlist/print
```

@codelogic Thank you very much ;)My hEX S | RB760iGS got swamped with ERROR messages in Log file:[adlist] no space to store a filecache full, not storing [ignoring repeated messages]Shame that mt.lvmanual pages for the DNSdo not provide solution, but rather ONLY give an advise:"Adlist is stored on device's internal memory. Ensure that there is enough free space to save the desired adlist."Also had to manually enter the commands one by one as it always finished with error on ROS 7.16if I paste the whole things into the bash..........# Check cache size and adjust if not large enoughCode:Select all# Remove all current adlistsCode:Select all# Fetch new adlist source file(s)Code:Select all# Create new adlist from fileCode:Select all# Remove temp file from RAMCode:Select all# Check the "DNS" SettingsCode:Select all# Check the "AdList"Code:Select all


---
### Author: Thu Jan 23, 2025 11:54 am
Date: Unknown

```
:if [/ip/dns/adlist find] do={/ip/dns/adlist reload};
```

```
# MikroTik Adlist USB by UkRainUa (without external functions)
# hardcoded: url, usb1-part1
# hAP ac2 7.16, 7.17 - test ok

:local scriptName "adlist";
/log debug "$scriptName started";
# update adlist function
:local UpdateAdlist do={
	:local scriptName "$1->UpdateAdlist->$description";
	:do {
		/log debug "$scriptName started";
		# fetch new adlist source file
		/tool/fetch mode=https check-certificate=yes url=$url output=file dst-path=$description as-value;
		# short delay to ensure file is created
		:delay 1s
		# check adlist
		:if ([/file/get [find name="$description"] value-name=size] > 1000000) do={
			:if [/ip/dns/adlist find where file=$description] do={
				/ip/dns/adlist reload;
				/log debug "$scriptName adlist reloaded";
			} else={
				# Create new adlist from file
				/ip/dns/adlist add file=$description ssl-verify=no;
				/log debug "$scriptName adlist added";
			};
		} else={
			/ip/dns/adlist remove [find where file=$description];
			/file/remove [find name=$description];
			/log warning "$scriptName runtime error: file not created or corrupted, adlist removed";
		};
		/log debug "$scriptName executed";
	} on-error={
		/log warning "$scriptName runtime error";
	};	
};
# check cache size and adjust if not large enough
:if ([ip/dns/get cache-size]!=32768) do={/ip/dns/set cache-size=32768};
# StevenBlackFGP: Unified hosts + fakenews + gambling + porn
:do {
	# run adlist update function
	$UpdateAdlist $scriptName url=https://raw.githubusercontent.com/StevenBlack/hosts/master/alternates/fakenews-gambling-porn/hosts description=usb1-part1/StevenBlackFGP;
} on-error={
	/log warning "$scriptName StevenBlackFGP update failed";
};
# StevenBlack: Unified hosts (adware + malware)
# :do {
	# # run adlist update function
	# $UpdateAdlist $scriptName url=https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts description=usb1-part1/StevenBlack;
# } on-error={
	# /log warning "$scriptName StevenBlack update failed;
# };
# HaGeZiLight
:do {
	# run adlist update function
	$UpdateAdlist $scriptName url=https://raw.githubusercontent.com/hagezi/dns-blocklists/refs/heads/main/hosts/light.txt description=usb1-part1/HaGeZiLight;
} on-error={
	/log warning "$scriptName HaGeZiLight update failed";
};
/log debug "$scriptName executed";
```

Hi! Saving lists to USB drive will save space on the router and the resource of the router's storage chip, will allow you to load lists immediately after rebooting the router:Code:Select allIf you have a USB in your router and a flash drive, add this script to the scheduler (once a day), you will always have an updated file on the USB drive::Code:Select allIf fetch ends with an error, the script does nothing but report an error, the file will be downloaded and reloaded next time. A script is possible with checking the message in the log about the success of the fetch execution, it will be a little more complicated, it is wise to use a universal external log analysis function for this.

