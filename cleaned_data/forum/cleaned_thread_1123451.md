# Thread Information
Title: Thread-1123451
Section: RouterOS
Thread ID: 1123451

# Discussion

## Initial Question
Dear All, I am using firmware 7.17 on routerboard model RB750Gr3 with firmware type mt7621LIn my case the output interface can have the following values in the log:out:(unknown 0),out:ether1_gw, out:bridge1, It is possible to find a groc pattern: out:([a-zA-Z0-9:_ ()]+),but it's not possible to put this into a variable in elastic searchIt would be great ifout:(unknown 0),would become for exampleout:unknown:0, or similar.The other question is, why is this interface unknown ? This happens primary when a rule drops a packet. Therefore a packet doesn't leave the FW and there is no outgoing interface. In this case a simple "na" for not available would be fine. But this is not for all rules so. I have drop rules where an dedicated out interface is listed. So why is this interface listed when the dropped packet does not pass this interface ?Kind regardsHans ---

## Response 1
So why is this interface listed when the dropped packet does not pass this interface ?Because egress interface is not known when FW drops connection/packet. Why? It depends on rule itself and L3 networks layout on your router. So without knowing that and full log line it's impossible for us to tell.BTW, what's your reason to bother about dropped connections/packets? Unless you're troubleshooting some weird behaviour it's IMO waste of time and computing resources (bot router and log server). ---

## Response 2
Hi mkx !Many thanks for your swift answer. It's far away that I want to bother you or the system. This mikrotik router is a great product. But even great products can be improved.My intention is to have a most complete firewall log because it is IMO important for analysing.For example this is a log for a rule where the packet is dropped and the out interface is listedFeb 3 11:42:56 mikrotik1 v4_drop_4r437_fwdlast forward: in:ether1_gw out:bridge1, connection-state:new, dnat src-mac 20:83:f8:a2:74:f2, proto UDP, 204.76.203.80:2842->192.168.241.190:123, NAT 204.76.203.80:2842->(x.y.z.a:123->192.168.241.190:123), len 36I removed the public IP by x.y.z.aThis is the related ruleadd action=drop chain=forward comment=\"v4_drop_4r437_fwdlast / End Of Forward (Drop)" log=yes log-prefix=\v4_drop_4r437_fwdlastand this is an example where the out interface is unkownFeb 3 11:43:03 mikrotik1 v4_drop_4r409_in_TCP input: in:ether1_gw out:(unknown 0), connection-state:new src-mac 20:83:f8:a2:74:f2, proto TCP (SYN), 213.32.32.90:43277->x.y.z.a:4544, len 60this is the configadd action=drop chain=input comment=\"v4_drop_4r409_in_TCP / End of Input / Drop " log=yes log-prefix=\v4_drop_4r409_in_TCP protocol=tcpIf you need more information then I am happy to share with you.With logging I have another recommendation or lets say a wish I want to tell you. In the log we can't see the action. For example accept, reject or drop. For a firewall it is essential if a packet can pass or not. I managed in my working live several firewalls of different vendors but I did never have the situation that the action was not listed in the logs. Maybe there is anywhere a switch in setup to change this behaviour which I do not know. Then be so kind and tell me where to look.Kind regardsHans-- ---

## Response 3
Feb 3 11:42:56 mikrotik1 v4_drop_4r437_fwdlastforward: in:ether1_gw out:bridge1, connection-state:new, dnat src-mac 20:83:f8:a2:74:f2, proto UDP, 204.76.203.80:2842->192.168.241.190:123, NAT 204.76.203.80:2842->(x.y.z.a:123->192.168.241.190:123), len 36Feb 3 11:43:03 mikrotik1 v4_drop_4r409_in_TCPinput: in:ether1_gw out:(unknown 0), connection-state:new src-mac 20:83:f8:a2:74:f2, proto TCP (SYN), 213.32.32.90:43277->x.y.z.a:4544, len 60Maybe I am reading this wrongly but the chain input should not have an out interface, while the chain forward should (possibly in some cases the out will be unknown in forward as well?).The news (good or bad cannot say) is that from 7.18 CEF format is/will be supported:https://help.mikrotik.com/docs/spaces/R ... 328094/LogFrom MikroTik RouterOS 7.18 support for CEF (Commont Event Format) logging format is added, as well as timestamp support for milliseconds. ---