# Thread Information
Title: Thread-1123350
Section: RouterOS
Thread ID: 1123350

# Discussion

## Initial Question
Just wondering if the consensus is that setting up Adguard or PiHole actually makes Internet life better?There's also NextDNS.ioThen there's just the well regarded 1.1.1.1, 9.9.9.9, and 8.8.8.8I've played with all of these, and the ad-blocking of Adguard and Pihole made some sites unviewable.Not at all claiming to have done an exhaustive study or to be an expert.Wondering what most people here use and recommend.Thanks ---

## Response 1
You should have a look at AdList, which is part of RouterOS:https://help.mikrotik.com/docs/spaces/R ... DNS-AdlistIt replaces my previous AdGuard and PiHole dockers (that ran on a Synology). ---

## Response 2
You should have a look at AdList, which is part of RouterOS:https://help.mikrotik.com/docs/spaces/R ... DNS-AdlistIt replaces my previous AdGuard and PiHole dockers (that ran on a Synology).Built in sounds great!Does this mean it is enabled and all set up? Any way to monitor what it is catching/blocking?
```
[admin@212RB5009] /ip/dns/adlist> print
Flags: X - disabled 
 0   url="https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts" ssl-verify=no match-count=48 name-count=33338

---
```

## Response 3
Match-count shows the number of hits on the list, this counter should be increasing.As yours is, it is active.I haven't found a way to log adlist specifically, you can do DNS logging temporarely (no clue what information it will provide). ---

## Response 4
Match-count shows the number of hits on the list, this counter should be increasing.As yours is, it is active.I haven't found a way to log adlist specifically, you can do DNS logging temporarely (no clue what information it will provide).Great, thanks very much. ---

## Response 5
Less than an hour -- it is catching a lot.Sure would be nice to know what it's blocking.I turned on topic DNS logging, but it's way too much info for my eyes to digest.What's interesting is this is just a private house and I'm the only one home. So, the caught ads are either from me or devices that are doing what they do all by themselves.
```
[admin@212RB5009] /ip/dns/adlist> print
Flags: X - disabled 
 0   url="https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts" ssl-verify=no match-count=1309 name-count=33338

---
```

## Response 6
Whats with github and stephen black? Is Mikrotik supporting this list, using this as a default?Stated otherwise, what lists are people using, and are they trustworthy, uptodate or effective and how do you know? ---

## Response 7
Whats with github and stephen black? Is Mikrotik supporting this list, using this as a default?Stated otherwise, what lists are people using, and are they trustworthy, uptodate or effective and how do you know?Sshhhh.... Steve's a big contributor the Mikrotik PAC. ---

## Response 8
Yes and tomorrow, Stephen cashes in his profits from the Trump bitcoin and stops working on the list...................... how useful will it be tomorrow??I mean lists are outacontrol...https://raw.githubusercontent.com/Steve ... ster/hostshttps://raw.githubusercontent.com/Polis ... Dhosts.txthttps://raw.githubusercontent.com/FadeM ... Spam/hostshttps://v.firebog.net/hosts/static/w3kbl.txthttps://adaway.org/hosts.txthttps://v.firebog.net/hosts/AdguardDNS.txthttps://v.firebog.net/hosts/Admiral.txthttps://v.firebog.net/hosts/Easyprivacy.txthttps://v.firebog.net/hosts/Prigent-Ads.txtAnd then there is this..........https://github.com/mullvad/dns-blocklis ... file#listsWhich led me to here..https://firebog.net/See the point!!! ---

## Response 9
Yes and tomorrow, Stephen cashes in his profits from the Trump bitcoin and stops working on the list...................... how useful will it be tomorrow??Why in the world would he do that when he gets $0.0001 every time his list redirects a paying ad to my screen while blocking an "uncooperative" advertiser's ad from showing up?That PAC money doesn't make itself ya know. ---

## Response 10
So does MT also provide a whitelist feature to help with false positives generated by the adlist feature LOL ---

## Response 11
It's not it's SENDING data to Mr. Black – worse case is some random website doesn't work if something got on his list which be easily remedied. Since it's a static file, no info is leaking out from "adlist" either beyond what normal would (i.e. something NOT on the list).I don't use any lists... but I do think the COMBO of some "adlist" with one of the protective DNS servers seems entirely reasonably.I used OpenDNS for a long while – as a low stakes way to always do "something" about malware. But past year+ been switching newer routers to Quad9's 9.9.9.9. My only thinking is OpenDNS seems to be languishing at the backwoods of cisco, so I worry about future of it. While the Quad9 folks seemed focused on DNS and malware, and independent. Much like the original OpenDNS folks, before they were absorbed by cisco.Also on same basis as trusting "Steven" for adlist... I watch a video from the Quad9 CEO a while back, he seemed reasonably trustworthy. And, without stereotyping too much, I'd trust the Swiss to run DNS, more than say some these Californians billionaires. ---

## Response 12
Nice AMMO. A touch of skepticism is always healthy. So just plain 9.9.9.9 no DOH etc.? ---

## Response 13
It's not it's SENDING data to Mr. Black – worse case is some random website doesn't work if something got on his list which be easily remedied. Since it's a static file, no info is leaking out from "adlist" either beyond what normal would (i.e. something NOT on the list).I don't use any lists... but I do think the COMBO of some "adlist" with one of the protective DNS servers seems entirely reasonably.I used OpenDNS for a long while – as a low stakes way to always do "something" about malware. But past year+ been switching newer routers to Quad9's 9.9.9.9. My only thinking is OpenDNS seems to be languishing at the backwoods of cisco, so I worry about future of it. While the Quad9 folks seemed focused on DNS and malware, and independent. Much like the original OpenDNS folks, before they were absorbed by cisco.Also on same basis as trusting "Steven" for adlist... I watch a video from the Quad9 CEO a while back, he seemed reasonably trustworthy. And, without stereotyping too much, I'd trust the Swiss to run DNS, more than say some these Californians billionaires.I was just joking.Seriously, the only reason I used that list is because that's what I saw people using in other threads. ---

## Response 14
Nice AMMO. A touch of skepticism is always healthy. So just plain 9.9.9.9 no DOH etc.?Yeah. For me, no DoH...Now I get the logic of DoH to "hide" your request - totally valid. It's just not my concern - someone, somewhere is collecting the DNS queries is my thought. So I'm not a big fan of introducing TCP's complexity (three-way handshake) into something so critical like DNS. UDP is going to be faster. Leaking some UDP DNS queries is better than potentially some oddities with DOH (either RouterOS or elsewhere) creeping up. But just my opinion.Now one of the public DNS server knowing about "bad domains", and returning NXDOMAIN or whatnot... I do like that part as I'd rather deal with a question about why one website does not work... Than say of all DNS not working because of a bug in DOH - or a PiHole container is down. ---

## Response 15
Just wondering if the consensus is that setting up Adguard or PiHole actually makes Internet life better?PiHole is excellent --- my Pihole currently blocks 7 million ad sites .. and its whitelisting capabilities work just greatI also strongly recommendMOABbeasue that will protect your "network" from the bad guys ... yes I am heavily predjuiced ---

## Response 16
I always use 9.9.9.9 as my DNS Service as it provides me basic protections from the worst malicious domains, but it provides no ad blocking and no tuning options. False positives are very rare with it and also no additional CPU cycles consumed.I tried different block lists with my Unbound setup and I had also Bind running as my recursive Name server with blocklists. Problem is sometimes the quality of the blocklists, you don´t usually know which ones to use, to have sufficient ad blocking but not having too much false positives. It´s also hard to maintain.I then used a PiHole setup which was great, but after testing AdGuard I found that it has a more versatile GUI and I can have better control. (Maybe Pihole improved since)What wasn´t mentioned here: all DNS based ad blocking is by far inferior compared to the browser plugins. I use UBlock Origin everywhere, where I can. This provides the best results.For basic protection and devices like IoT/mobile devices/TVs I still have AdGuard+Quad9, but the emerging issue is, that I can´t block DoH for those. ---

## Response 17
I don't concern myself with using DoH, but primarily because I don't have the depth of understanding to be worried about it. My basic understanding that it encrypts DNS requests and thereby provides greater privacy, but more so that it prevents an attack coming in by way of hijacking a DNS request. (There's only so much a guy can learn and implement....)And, I tried implementing browser-based ad protection and it was a nightmare. I personally use 6 or 7 physical devices each with a browser and some of those I frequently use 2 or 3 different browsers (Chrome, Edge, and DuckDuckGo) because they behave differently (i.e., some things and sites work on one but not another) and because the caches screw up my multiple user logins to the same services like gmail and office365. So, maintaining browser-based ad protection would be onerous and ongoing. And, the fine tuning of these ad-blockers was rediculously time-consuming.And, generally, I place high value on simplicity of set up and a set it and leave approach.That said, I set up the adlist and it has caught tens of thousands of requests (I don't actually know what "caught" means) and I just had my first issue:cnbc.com complained that I am using an ad-blocker and depriving them of revenue. They asked if I could shut it off.I think this goes to the balance, or compromise, that will inevitably be faced with these types of systems.I'll continue using the single Stephen adlist, despite the only feedback or data I get is a complaint that I'm depriving a web site of needed revenue (as opposed to feedback that I am being spared undesired ads). ---

## Response 18
It would be enough for all users to agree and boycott the products in the EXCESSIVE advertising banners, sending protest emails to the companies in question, and they would stop advertising in that way, knowing that it would backfire on them...I understand those who try to earn money with what they do for free, but there also needs to be a balance, especially on advertising done on things for which you are already paying the subscription. (I am not referring to the internet subscription).If "my ISP" made me pay €2.00 more per month to have internet WITHOUT advertising, I would have already signed up... (less power consumed for pihole & Co.).Too bad that as an ISP (on Italy) I am required by law to block the sites that the government tells me to, but at the same time I cannot prevent my customers from reaching the others...(otherwise I would have already put the filter on all the advertising sites for my customers)... ---

## Response 19
Then in the future, and easily too(given how people with the "security flag" start using DoH, https and other bullshit that worsen management and do not increase security at all),I see that web pages will no longer be rendered by the browser, but interactive images and interactive videos will arrive in which the banners will be integrated into the content and not removable by anything, since everything will be encrypted and not modifiable on computer, like copy-protected streaming content that is uncompressed on GPU... ---

## Response 20
9.9.9.9 DOH still doesn't work properly for me, I have serveral drops per day.1.1.1.1 works a treat! ---

## Response 21
9.9.9.9 DOH still doesn't work properly for me, I have serveral drops per day.1.1.1.1 works a treat!I watched a video from the Quad9 CEO [... —] I'd trust the Swiss to run DNS, more than these Californians billionairesFWIW Quad9 guy did another interview recently - I guess the all the tracking caused it to appear in my YouTube feed –https://www.youtube.com/watch?v=KDi0YvS ... cXVhZDk%3DAnd to @rextended's points and 9.9.9.9DoH...A touch of skepticism is always healthy. So just plain 9.9.9.9 no DOH etc.?Yeah. For me, no DoH...[...]I'm not a big fan of introducing TCP's complexity (three-way handshake) into something so critical like DNS. UDP is going to be faster. Leaking some UDP DNS queries is better than potentially some oddities with DOH (either RouterOS or elsewhere) creeping up. But just my opinion. [...]Adding also even more potentially fragile certificate checking on DoH that risk breaking stuff down the road. Apparently these DoH breakage happened sooner for @ToTheFull.And, on the later part of topic, for the record, I'm also not a big fan of an ANY "content filtering" - whether ads, porn, or tiktok —from the technical POVthat the standard/protocols nowadays simply do notreadilyallow it. These modern React/etc website make it very difficult to do HTML modification on client-side, too. Just my opinion – but I'd rather see an adthanhave a webpage take >100ms longer to load. And certainly don't want to hear about why other people's "web pages are slow" because I'm doing complex stuff on the network.... ---

## Response 22
I've been using PiHole for a number of years and it works for me. It handles the DHCP and DNS for my network too. Occasionally, I'll have to add something to a whitelist or blacklist. Also, best results are achieved when also using a good browser with a plugin like Ublock origin. ---

## Response 23
@Amm0 thanks for the context and points of view, also an interesting watch!. I honestly am still using Add-Blocking to stop some older devices from being bombarded with adds mostly on News Sites etc, also advertising to me is an irritation plain and simple. So infact I could argue that things for us at least in the main are less cluttered. Faster DNS responses... No! ---

## Response 24
From my experience regarding DNS privacy DoH/DoT is somewhat faster and much safer than recursive DNS on internet connection with higher latency like LTE. I have setup whereUnboundis used as upstream DNS forPiholeand ROS DNS, both running in its ROS container. FirstUnboundwas configured to be recursive DNS but I experienced high DNS response times for non cached DNS records due to my Internet connection latency, after switching to DoT it is faster.Also I noticed that (in my country) requests to Cloudflare (1.1.1.1) and Quad9 (9.9.9.9) DoT DNS are routed to DNS servers hosted in my country and they are using upstream DNS of government agency and not acting as recursive (or they are recursive but intercepted) which raised privacy concern. Checked on several DNS leak sites. So I configuredAdGuardDoT DNS (94.140.14.140:853) asUnboundupsream which is not hosted in my country and DNS leaks sites are reporting its DNS. ---

## Response 25
Update:After experiencing some degree of failures loading a few websites (cnbc.com, aplus.net's domain searching, and a couple of others) I decided to abandon the adlist DNS ad-blocking solutions.This seems to be a pattern of mine: Every year or 2 I decide to do what the big boys indicate is better and smarter in this regard, and the costs/limitations/hassles are just too great.All I have to answer to are family and guests -- I can't imagine supporting clients with an ad-blocking system (which appears to be all solutions) that breaks random web sites.Maybe it's a full-employment thing (;-) ---

## Response 26
./., ---

## Response 27
I had good experience with PiHole, but my personal favorite for small local DNS with or without filtering is Technitium (https://github.com/TechnitiumSoftware/DnsServer). It supports UDP/TCP, DOH with http2/3, DNS over TLS and DNS over QUIC all both as server and client. I'm running it in in both my home and my lab network in a container on a RB5009. Beside Docker/Container, it also can be natively installed on Windows, Linux, macOS and Raspberry Pi OS. I run it is a filtering forwarder to 9.9.9.9 with DOH. In my experiences the Technitium upstream DOH client is much more reliable compared to PiHole or ROS. It is very clever in reusing existing TCP connection and running upstream queries in parallel. All fully configurable.If you run into issues with webpages or services due to DNS filtering with AdGuard/PiHole/Technitium is mostly depending on the filter lists in use. I recommend the 4 lists below, they are the ones used by uBlock origin in default configuration and a such very well maintained:https://easylist.to/easylist/easylist.txthttps://easylist.to/easylist/easyprivacy.txthttps://malware-filter.gitlab.io/malwar ... online.txthttps://pgl.yoyo.org/adservers/serverli ... rmat=hosts ---

## Response 28
I do suggest you give mozerds service a try.. if just for a month, I am curious as to what your experience will be like.I predict you would be very content. ---

## Response 29
I do suggest you give mozerds service a try.. if just for a month, I am curious as to what your experience will be like.I predict you would be very content.It's just not that high on my priority list.And, just about any level of hassle is more than have the time and patience for at this point. So, even if it (or any solution) works great, there will likely still be one of two web sites that are problematic and/or require a little tweaking, configuring, or compromise.If 9.9.9.9 is good enough for so many knowledgable people, it's good enough for me. ---

## Response 30
Well, blacklisting needs some time and effort until all works well. In my experience if you invest some time in the first few days to check the logs and create some exceptions, then it becomes almost completely hassle free. I need to add a new exception maybe once a year (mostly for my kids dubious games). It´s really easy to do on Pihole and and Adguard.In contrast 9.9.9.9 has never blocked anything for me it should not have blocked. ---

## Response 31
Well, blacklisting needs some time and effort until all works well. In my experience if you invest some time in the first few days to check the logs and create some exceptions, then it becomes almost completely hassle free. I need to add a new exception maybe once a year (mostly for my kids dubious games). It´s really easy to do on Pihole and and Adguard.In contrast 9.9.9.9 has never blocked anything for me it should not have blocked.This is fascinating. And confusing.Doesn't every user regularly visit new sites? If I visit even a small handful of sites that I've never visited each week, and there were 20 such users on a network served by an ad-protected DNS system, that's 100 new sites/week.No idea how many of those will be affected by the adlist, but even one or 2 means that every week there is tweaking to do, sometimes at the behest of a frustrated user (worst of whom would be me). ---

## Response 32
I've used every kind of dns/add-blocker over the years, I think pihole was the best for DoH but I've been using Mikrotiks offering for the last 3 months.That is DoH with Adlists, I don't need to see every detail or what people have looked @ not interested hence Adlists is fine.Along that journey I've found hagezi's pro listhttps://github.com/hagezi/dns-blockliststo be the best balance for me without having to meddle.My problem with mikrotik has been over the said period 9.9.9.9 DoH is giving me various timeout /drop issues vs cloudflare. why that is I don't know, it's just easyer for me to just use Cloudflare DoH. Am i happy with that situation, No, but it must be better than Google!Also I use a certificate to verify the addlist, could any of this break at any time, maybe. But I only have 4 people and 20 devices to look out for.Then again, our lot are savy enough to bang 1.1.1.1/53 at any point they wish. or shout pause please if something isn't working! ---

## Response 33
This is fascinating. And confusing.Doesn't every user regularly visit new sites? If I visit even a small handful of sites that I've never visited each week, and there were 20 such users on a network served by an ad-protected DNS system, that's 100 new sites/week.No idea how many of those will be affected by the ad list, but even one or 2 means that every week there is tweaking to do, sometimes at the behest of a frustrated user (worst of whom would be me).I´m not sure I get your point. The thing is, not every user visits new sites every time. Most of the traffic goes to the same sites again and again. Besides I don´t have to do anything most of the time if a user visits a new site. It will just work and most of the ads are hopefully blocked. If not a 100%, I don´t care much. Adguard is just one measure and UblockOrigin takes care about almost a 100% of annoying stuff and it almost never makes any trouble. I take action on Adguard mostly to add some white list items, seldom I do some blacklisting.The results are not perfect, but better then just having nothing.As for 9.9.9.9 and DoH: don´t use DoH, if you are just using it as your DNS server for your router over UDP 53 , then you will have zero issues.Btw. I use one more trick in my network: to enforce everyone to use the same filtering, I Dst NAT every DNS request originating inside my net to my internal DNS server. That takes care of forwarding the requests over the enforced servers. ---

## Response 34
My problem with mikrotik has been over the said period 9.9.9.9 DoH is giving me various timeout /drop issues vs cloudflare. why that is I don't know, it's just easyer for me to just use Cloudflare DoH. Am i happy with that situation, No, but it must be better than Google!You could file a ticket with Quad9, since Mikrotik's DoH DNS generally works, or at least not been wholesale complaints about it. There are a lot of Mikrotik in world, so they may want to know it's flake or have some idea. Long short, but worth putting on their radar:https://www.quad9.net/support/contacti.e.Quad9 DNS does document how to setup a Mikrotik:https://docs.quad9.net/Setup_Guides/Ope ... rypted%29/ ---

## Response 35
This is fascinating. And confusing.Doesn't every user regularly visit new sites? If I visit even a small handful of sites that I've never visited each week, and there were 20 such users on a network served by an ad-protected DNS system, that's 100 new sites/week.No idea how many of those will be affected by the ad list, but even one or 2 means that every week there is tweaking to do, sometimes at the behest of a frustrated user (worst of whom would be me).I´m not sure I get your point. The thing is, not every user visits new sites every time. Most of the traffic goes to the same sites again and again. Besides I don´t have to do anything most of the time if a user visits a new site. It will just work and most of the ads are hopefully blocked. If not a 100%, I don´t care much. Adguard is just one measure and UblockOrigin takes care about almost a 100% of annoying stuff and it almost never makes any trouble. I take action on Adguard mostly to add some white list items, seldom I do some blacklisting.The results are not perfect, but better then just having nothing.As for 9.9.9.9 and DoH: don´t use DoH, if you are just using it as your DNS server for your router over UDP 53 , then you will have zero issues.Btw. I use one more trick in my network: to enforce everyone to use the same filtering, I Dst NAT every DNS request originating inside my net to my internal DNS server. That takes care of forwarding the requests over the enforced servers.My point is the likelihood of a user encoutering a site that has a problem, and thereby requiring work on my part, is too high.In a few days of using adlist with a single list, I alone encountered several sites that had problems. ---

## Response 36
Hence why I keep harping you to try just for a month a service that is used for a wide variety of users with no issues....... It may provide you sanity. ---

## Response 37
Hi, I really like the Quad9 9.9.9.9 using DNS over HTTPS. I have followed their quide how to setup Mikrotik. It is working but I have daily this in log: DoH server response not OK: 502: no downstream server availableAny solution?Thank you ---

## Response 38
If it's multiple people with Quad9 over DoH having issues, "someone" really should file a bug with Mikrotik and/or Quad9, if it's repo'able. Mikrotik does not always take some action from the forum. DNS is so critical to things & ideally DoH be 100% reliable... but errors in DNS often causes subtle/hard problems sometimes, so deserves some attention if it's multiple folks... ---

## Response 39
I've put a Ticket in to quad9 yesterday, nothing heard so far. Will update when I get any info.I think I've already said multiple times it works with Cloudflare DoH fine. So i guess it can't just be mikrotiks fault!If i'm honest, yesterday wasn't the best day to put a ticket in with problems going on near me. ---

## Response 40
I followed Quad9's documentation (https://docs.quad9.net/Setup_Guides/Ope ... rypted%29/) [also listed above] and it was working but Netflix on my TV thought I was in a different country (Eastern European by my guess on the language). Are there any ways to fix this (direct to US servers?)?Thanks in advance (I'm very green at this) ---

## Response 41
I do suggest you give mozerds service a try.. if just for a month .... .... ....MOAB has a10 day Free Trialoffer for those wishing to see MOAB deterrentsat work ...to see the free offer scroll down to near the bottom of the page that is linked above ...And following is what my Pi-Hole looks likePi-Hole.jpg ---

## Response 42
Pi-Hole picture added above showing 7 million ad sites with a 70% block rate ... ---

## Response 43
I followed Quad9's documentation (https://docs.quad9.net/Setup_Guides/Ope ... rypted%29/) [also listed above] and it was working but Netflix on my TV thought I was in a different country (Eastern European by my guess on the language). Are there any ways to fix this (direct to US servers?)?Thanks in advance (I'm very green at this)IDK. I take it you sure you don't have some VPN active or anything. But streaming sites do a lot of complex things to get you a server (or cache) close to you... so it totally could be DNS somehow involved in the "wrong country" in that case. There is a "Get Support" at bottom of the Quad9 page on Mikroitk, as suggested about, it worth a ticket if you think it's Quad9 specifically - that how these things improve. The alternative is NOT using DoH with Quad9, or using Cloudflare's DoH since that seem to get relatively good reviews, at least on performance/reliability. ---