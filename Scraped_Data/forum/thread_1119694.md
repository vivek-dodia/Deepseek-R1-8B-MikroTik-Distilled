---
title: Thread-1119694
url: https://forum.mikrotik.com/viewtopic.php?p=1119694&sid=49f92a630bc7970d8ca50523be880e8f#p1119694
thread_id: 1119694
section: RouterOS
post_count: 6
date_crawled: 2025-02-03T13:43:32.803647
---

### Post 1
Author: Unknown
Date: Unknown

Hi, we are evaluating a Mikrotik CCR2116-12G-4s+ to replace our Cisco routers in an LNS role. One issue we have encountered is trying to place a PPP session’s routes into a VRF, based on a RADIUS reply attribute. Similar to this forum entry.viewtopic.php?t=191226It is understood that Mikrotik do not support an equivalent RADIUS attribute such as Cisco’s AV Pairs. But the Mikrotik-Group attribute can be sent in the RADIUS reply to override the default PPP profile for that user’s session.We have tried to use this feature to apply a non-default PPP profile (ppp-profile-vrf1) to a user. This non-default PPP profile has an associated interface-list which has been added to a VRF (vrf1). This seems to work as expected with the dynamic PPP interface being added to the interface-list.1 L2TP server.png2 PPP profiles.png3 VRF.png4 PPP session.pngThough we have noticed some of the PPP session’s routes on the LNS are added to the VRF and some are not. In our case the Framed-IP-Address and Delegated IPv6-Prefix routes have been added to the VRF, but the Framed-Route and the Framed-IPv6-Prefix have not.See the diagram below showing the topology and the ip and ipv6 route print outputs.Routes in purple in VRF as expected. Routes in red not in VRF.5 Topology and routes.pngThe route print detail output is below. I have noticed the routes not present in the VRF are marked as inactive and have a missing immediate-gw.Code:Select all[admin@lns3]>/ip/route/printdetFlags:D-dynamic;X-disabled,I-inactive,A-active;c-connect,s-static,r-rip,b-bgp,o-ospf,i-is-is,d-dhcp,v-vpn,m-modem,y-bgp-mpls-vpn;H-hw-offloaded;+-ecmpDAbdst-address=81.145.120.14/32routing-table=main gateway=192.0.2.34immediate-gw=192.0.2.34%vlan1184 distance=20scope=40target-scope=10suppress-hw-offload=noDAbdst-address=81.145.120.15/32routing-table=main gateway=192.0.2.34immediate-gw=192.0.2.34%vlan1184 distance=20scope=40target-scope=10suppress-hw-offload=noDAbdst-address=91.151.11.253/32routing-table=main gateway=192.0.2.34immediate-gw=192.0.2.34%vlan1184 distance=20scope=40target-scope=10suppress-hw-offload=noDAbdst-address=91.151.11.254/32routing-table=main gateway=192.0.2.34immediate-gw=192.0.2.34%vlan1184 distance=20scope=40target-scope=10suppress-hw-offload=noDAcdst-address=192.0.2.0/28routing-table=main gateway=sfp-sfpplus2 immediate-gw=sfp-sfpplus2 distance=0scope=10suppress-hw-offload=nolocal-address=192.0.2.5%sfp-sfpplus2DAcdst-address=192.0.2.32/30routing-table=main gateway=vlan1184 immediate-gw=vlan1184 distance=0scope=10suppress-hw-offload=nolocal-address=192.0.2.33%vlan1184DAcdst-address=192.0.2.49/32routing-table=vrf1 gateway=<l2tp-testppp01@mt-lab.net>@vrf1immediate-gw=<l2tp-testppp01@mt-lab.net>distance=0scope=10suppress-hw-offload=nolocal-address=192.0.2.241%<l2tp-testppp01@mt-lab.net>@vrf1DIvHdst-address=192.0.2.64/28routing-table=main pref-src=""gateway=<l2tp-testppp01@mt-lab.net>immediate-gw=""distance=1scope=30target-scope=10suppress-hw-offload=noDAcdst-address=192.0.2.240/32routing-table=main gateway=Loopback0immediate-gw=Loopback0distance=0scope=10suppress-hw-offload=nolocal-address=192.0.2.240%Loopback0DIcHdst-address=192.168.88.0/24routing-table=main gateway=ether13 distance=0scope=10suppress-hw-offload=nolocal-address=192.168.88.3%ether13DAcdst-address=192.0.2.241/32routing-table=vrf1 gateway=Loopback1@vrf1immediate-gw=Loopback1distance=0scope=10suppress-hw-offload=nolocal-address=192.0.2.241%Loopback1@vrf1[admin@lns3]>/ipv6/route/printdetFlags:D-dynamic;X-disabled,I-inactive,A-active;c-connect,s-static,r-rip,b-bgp,o-ospf,d-dhcp,v-vpn,m-modem,g-slaac,y-bgp-mpls-vpn;H-hw-offloaded;+-ecmpDAcdst-address=2001:db8:2:2::/64routing-table=main gateway=sfp-sfpplus2 immediate-gw=sfp-sfpplus2 distance=0scope=10DIvHdst-address=2001:db8:8:4::/64routing-table=main gateway=<l2tp-testppp01@mt-lab.net>immediate-gw=""distance=1scope=30target-scope=10DAddst-address=2001:db8:100:300::/56routing-table=vrf1 gateway=fe80::36ed:1bff:fe85:f380%<l2tp-testppp01@mt-lab.net>@vrf1immediate-gw=fe80::36ed:1bff:fe85:f380%<l2tp-testppp01@mt-lab.net>distance=1scope=30target-scope=10vrf-interface=<l2tp-testppp01@mt-lab.net>DAcdst-address=fe80::%sfp-sfpplus2/64routing-table=main gateway=sfp-sfpplus2 immediate-gw=sfp-sfpplus2 distance=0scope=10DAcdst-address=fe80::%sfp-sfpplus4/64routing-table=main gateway=sfp-sfpplus4 immediate-gw=sfp-sfpplus4 distance=0scope=10DAcdst-address=fe80::%<l2tp-testppp01@mt-lab.net>/64routing-table=vrf1 gateway=<l2tp-testppp01@mt-lab.net>@vrf1immediate-gw=<l2tp-testppp01@mt-lab.net>distance=0scope=10DAcdst-address=fe80::%Loopback0/64routing-table=main gateway=Loopback0immediate-gw=Loopback0distance=0scope=10DAcdst-address=fe80::%vlan1184/64routing-table=main gateway=vlan1184 immediate-gw=vlan1184 distance=0scope=10DAcdst-address=fe80::%Loopback1/64routing-table=vrf1 gateway=Loopback1@vrf1immediate-gw=Loopback1distance=0scope=10My questions are :-1.	Is this a supported configuration - LNS server placing PPP session in a VRF ? I have not found a definitive response in the forums to confirm this can be achieved with the current software. It would be great to understand if this is or is not supported yet. If it is, could you point me in the right direction where I am going wrong in the supplied config below. I have raised a ticket with Mikrotik support but no response so far.2.	Can this be made to work as intended. I have seen scripts being used in the forums during the ppp up and down stages to achieve specific goals. But am not sure if this can be achieved or what is required to add the missing routes into the VRF. I am relatively new to the Mikrotik platform.From the following post it seems VRF traffic is not hardware offloaded currently, so even if this was working as expected this platform would not scale for this purpose. Though hardware offloaded VRF traffic is intended to be offered in a future release.viewtopic.php?t=184637&sid=aed5df58cc58 ... fa71fac56fAny comments or pointers would be gratefully received.Many thanks for your help.Mikrotik CCR2116-12G-4s+ config. Tested with RouterOS 7.11.lns3-config.txtCisco CPE configcpe-config.txt

---
### Post 2
Author: Unknown
Date: Unknown

I got a reply today from Mikrotik support re this functionality.MikroTik support #[SUP-126171]: LNS role - Add PPP session routes into a VRFHello, James.No, currently this feature is not supported to set VRF from RADIUS, and at least your described process is more workaround or hack how to achieve few options.

---
### Post 3
Author: Unknown
Date: Unknown

Have you tested v7.12? I opened a ticket for the same (but with static vrf assignments) and they recommended to test with 7.12.Unfortunately I had no time to test it. #SUP-121505But I'd really appreciate a VRF attribute too, which should not be too hard to implement.

---
### Post 4
Author: Unknown
Date: Unknown

Update:Hello,At the moment address and route will be added to main VRF. We will see how this can be improved in the future. Thanks for the report.Best regards,

---
### Post 5
Author: Unknown
Date: Unknown

We have exactly the same issue.did anyone tested with 7.16beta4?*) route - place static route in the correct VRF when vrf-interface parameter is used;

---
### Post 6
Author: Unknown
Date: Unknown

Still broken in 7,17

---
